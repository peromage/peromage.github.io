<!doctype html><html xmlns=http://www.w3.org/1999/xhtml xml:lang=en-us lang=en-us><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1,maximum-scale=1"><title>Shadowsocks Quick Setup &#183;</title><meta name=description content="Interesting content."><meta name=keywords content="Interesting keywords."><link rel=stylesheet href=https://peromage.github.io/css/skeria.css><link rel=stylesheet href=https://peromage.github.io/css/font.awesome.6.1.2.all.min.css></head><body><div class=topbar><div class=topbar-sticky><a href=https://peromage.github.io/ style=text-decoration:none><h1>undefined behavior</h1></a><span class=lead>tb;dr - too boring; don&rsquo;t read</span>
<span class=topbar-nav><p><span class=topbar-nav-item><a href=https://peromage.github.io/>Recent</a>
</span><span class=topbar-nav-item><a href=https://peromage.github.io/posts>All Posts</a>
</span><span class=topbar-nav-item><a href=https://peromage.github.io/categories>Categories</a>
</span><span class=topbar-nav-item><a href=https://peromage.github.io/tags>Tags</a>
</span><span class=topbar-nav-item><a href=https://peromage.github.io/about>About</a>
</span><span class=topbar-nav-item><a href=https://peromage.github.io/search>Search</a></span></p></span></div></div><div class="content container"><div class=post><h1 class=post-title>Shadowsocks Quick Setup</h1><span class=post-date>Mar 13, 2022
&nbsp;&#183;&nbsp; 2 minute read
&nbsp;&#183;&nbsp;
<a class=label href=https://peromage.github.io/linux>linux</a></span><p>This note is written for my personal convenience.</p><h2 id=server-setup>Server Setup</h2><h3 id=installation>Installation</h3><p>Use system package manager to install <code>shadowsocks-libev</code>. In this case, for Arch Linux it is <code>pacman</code>.</p><p>There is also a Python package which can be installed by <code>pip</code> but it seems not to be maintained for a long time.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>$ sudo pacman -S shadowsocks-libev
</span></span></code></pre></div><h3 id=shadowsocks-server-configuration>Shadowsocks Server Configuration</h3><p>Config file is located at <code>/etc/shadowsocks/myserver.json</code>. On FreeBSD it is <code>/usr/local/etc/shadowsocks/myserver.json</code></p><p>The file name can vary.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-json data-lang=json><span style=display:flex><span><span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>&#34;server&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;0.0.0.0&#34;</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>&#34;server_port&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#0000cf;font-weight:700>8388</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>&#34;password&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;mypassword&#34;</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>&#34;timeout&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#0000cf;font-weight:700>300</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>&#34;method&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;chacha20-ietf-poly1305&#34;</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>&#34;fast_open&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#204a87;font-weight:700>false</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>&#34;workers&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#0000cf;font-weight:700>1</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>&#34;nameserver&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;8.8.8.8&#34;</span>
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>}</span>
</span></span></code></pre></div><p><strong>Note</strong>: For server, <code>"local_address": "127.0.0.1"</code> and <code>"local_port": 1080</code> would cause problems so don&rsquo;t them.</p><h3 id=start-the-server-as-a-system-service>Start the Server as A System Service</h3><p>The server can be started in the background but it&rsquo;s not persistent after reboot.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>$ ss-server -c /etc/shadowsocks/myserver.json <span style=color:#000;font-weight:700>&amp;</span>
</span></span></code></pre></div><p>Use <code>systemd</code> to make it run automatically.</p><p><strong>Note</strong>: The config file name has to be placed after <code>@</code>.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>$ sudo systemctl <span style=color:#204a87>enable</span> shadowsocks-libev-server@myserver
</span></span><span style=display:flex><span>$ sudo systemctl start shadowsocks-libev-server@myserver
</span></span></code></pre></div><h2 id=client-helper>Client Helper</h2><h3 id=ss-access-key-generation-script--bash-script>SS Access Key Generation Script (Bash Script)</h3><p>This script will prompt you to input parameters that are in the config file to generate a base64 encoded link.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span><span style=color:#8f5902;font-style:italic>#!/usr/bin/bash
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span><span style=color:#8f5902;font-style:italic># Usage: this_script.sh</span>
</span></span><span style=display:flex><span><span style=color:#204a87>read</span> -p <span style=color:#4e9a06>&#39;Method: &#39;</span> -r ss_method
</span></span><span style=display:flex><span><span style=color:#204a87>read</span> -p <span style=color:#4e9a06>&#39;Password: &#39;</span> -r ss_password
</span></span><span style=display:flex><span><span style=color:#204a87>read</span> -p <span style=color:#4e9a06>&#39;Server IP: &#39;</span> -r ss_server_ip
</span></span><span style=display:flex><span><span style=color:#204a87>read</span> -p <span style=color:#4e9a06>&#39;Server Port: &#39;</span> -r ss_server_port
</span></span><span style=display:flex><span><span style=color:#204a87>echo</span> <span style=color:#4e9a06>&#34;ss://&#34;</span> <span style=color:#204a87;font-weight:700>$(</span><span style=color:#204a87>printf</span> <span style=color:#4e9a06>&#34;</span><span style=color:#4e9a06>${</span><span style=color:#000>ss_method</span><span style=color:#4e9a06>}</span><span style=color:#4e9a06>:</span><span style=color:#4e9a06>${</span><span style=color:#000>ss_password</span><span style=color:#4e9a06>}</span><span style=color:#4e9a06>@</span><span style=color:#4e9a06>${</span><span style=color:#000>ss_server_ip</span><span style=color:#4e9a06>}</span><span style=color:#4e9a06>:</span><span style=color:#4e9a06>${</span><span style=color:#000>ss_server_port</span><span style=color:#4e9a06>}</span><span style=color:#4e9a06>&#34;</span> <span style=color:#000;font-weight:700>|</span> base64<span style=color:#204a87;font-weight:700>)</span>
</span></span></code></pre></div><h3 id=ss-access-key-generation-script--javascript>SS Access Key Generation Script (JavaScript)</h3><p>This approch requires Node.js but it can parse config file automatically.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=display:flex><span><span style=color:#8f5902;font-style:italic>// Usage: node this_script.js &lt;config_file&gt;
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span><span style=color:#204a87;font-weight:700>let</span> <span style=color:#000>argv</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>process</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>argv</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>slice</span><span style=color:#000;font-weight:700>(</span><span style=color:#0000cf;font-weight:700>2</span><span style=color:#000;font-weight:700>);</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>if</span> <span style=color:#000;font-weight:700>(</span><span style=color:#000>argv</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>length</span> <span style=color:#ce5c00;font-weight:700>&lt;</span> <span style=color:#0000cf;font-weight:700>1</span><span style=color:#000;font-weight:700>)</span> <span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>    <span style=color:#000>console</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>log</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34;nothing&#34;</span><span style=color:#000;font-weight:700>);</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>return</span><span style=color:#000;font-weight:700>;</span>
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>const</span> <span style=color:#000>fs</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>require</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#39;fs&#39;</span><span style=color:#000;font-weight:700>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>let</span> <span style=color:#000>config_file</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>argv</span><span style=color:#000;font-weight:700>[</span><span style=color:#0000cf;font-weight:700>0</span><span style=color:#000;font-weight:700>];</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>let</span> <span style=color:#000>config_json</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>JSON</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>parse</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>fs</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>readFileSync</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>config_file</span><span style=color:#000;font-weight:700>));</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>let</span> <span style=color:#000>ss_url</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#4e9a06>&#34;ss://&#34;</span> <span style=color:#ce5c00;font-weight:700>+</span> <span style=color:#000>btoa</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>`</span><span style=color:#4e9a06>${</span><span style=color:#000>config_json</span><span style=color:#000;font-weight:700>[</span><span style=color:#4e9a06>&#39;method&#39;</span><span style=color:#000;font-weight:700>]</span><span style=color:#4e9a06>}</span><span style=color:#4e9a06>:</span><span style=color:#4e9a06>${</span><span style=color:#000>config_json</span><span style=color:#000;font-weight:700>[</span><span style=color:#4e9a06>&#39;password&#39;</span><span style=color:#000;font-weight:700>]</span><span style=color:#4e9a06>}</span><span style=color:#4e9a06>@</span><span style=color:#4e9a06>${</span><span style=color:#000>config_json</span><span style=color:#000;font-weight:700>[</span><span style=color:#4e9a06>&#39;server&#39;</span><span style=color:#000;font-weight:700>][</span><span style=color:#0000cf;font-weight:700>0</span><span style=color:#000;font-weight:700>]</span><span style=color:#4e9a06>}</span><span style=color:#4e9a06>:</span><span style=color:#4e9a06>${</span><span style=color:#000>config_json</span><span style=color:#000;font-weight:700>[</span><span style=color:#4e9a06>&#39;server_port&#39;</span><span style=color:#000;font-weight:700>]</span><span style=color:#4e9a06>}</span><span style=color:#4e9a06>`</span><span style=color:#000;font-weight:700>);</span>
</span></span><span style=display:flex><span><span style=color:#000>console</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>log</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>ss_url</span><span style=color:#000;font-weight:700>);</span>
</span></span></code></pre></div></div></div><script src=https://peromage.github.io/js/mathjax.3.2.2.tex-svg.min.js></script><div class=bottombar><div class=bottombar-sticky><div class=icons><span class=icons-item><a href=https://github.com/peromage target=_blank><i class="fab fa-github"></i></a> </span><span class=icons-item><a href=https://www.linkedin.com/in/fangdeng/ target=_blank><i class="fab fa-linkedin fa-1x"></i></a> </span><span class=icons-item><a href=mailto:fang@elfang.com><i class="fas fa-envelope fa-1x"></i></a> </span><span class=icons-item><a href=/me.pub><i class="fas fa-key fa-1x"></i></a></span></div><div class=footer><p>&copy; 2025 , <a href=https://peromage.github.io/license/>License</a><br><a href=/privacy title="Privacy notice">Privacy notice</a></p></div></div></div></body></html>