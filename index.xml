<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>Skag Den</title><link>https://peromage.github.io/</link><description>Recent content on Skag Den</description><generator>Hugo -- gohugo.io</generator><language>en-us</language><lastBuildDate>Wed, 26 Jan 2022 20:34:18 +0000</lastBuildDate><atom:link href="https://peromage.github.io/index.xml" rel="self" type="application/rss+xml"/><item><title>Minimalist's Multi-boot USB Drive</title><link>https://peromage.github.io/p/minimalists-multi-boot-usb-drive/</link><pubDate>Wed, 26 Jan 2022 20:34:18 +0000</pubDate><guid>https://peromage.github.io/p/minimalists-multi-boot-usb-drive/</guid><description>&lt;h1 id="story">Story&lt;/h1>
&lt;p>Recently I&amp;rsquo;ve realized a fact that I always have needs to keep a multi-boot USB in my pocket for either Linux or Windows installation. There are a lot tools out there already but I don&amp;rsquo;t really like them. At least, I mean, they are too flashy to me. A beautiful boot menu seems not to be attractive. What I need is just a simple and practical maybe a little ugly boot device. It should be minimalist. More importantly, it has to be easy to setup with the tools on the system already and maintainable. No funky scripts.&lt;/p>
&lt;h1 id="old-solution---clunky">Old Solution - Clunky&lt;/h1>
&lt;p>I&amp;rsquo;ve been using this solution for a very long time. Setup is pretty straight forward.&lt;/p>
&lt;p>The partition scheme used on the USB drive is like (GPT):&lt;/p>
&lt;pre>&lt;code>/dev/sda1 - 100 GB. NTFS. Data partition
/dev/sda2 - 512 MB. FAT. EFI partition
/dev/sda3 - 1 MB. No filesystem. BIOS boot partition used by GRUB
/dev/sda4 - 8 GB. NTFS. Windows ISO files
/dev/sda5 - 2 GB. FAT. Arch Linux ISO files
&lt;/code>&lt;/pre>&lt;p>So the idea is having a big data partition at the front for better access, then installing GRUB files on the second EFI partition with both EFI and BIOS support (Implemented by the third BIOS boot partition. The partition order doesn&amp;rsquo;t matter). Finally, create dedicated partitions to contain the extracted files from installation ISOs.&lt;/p>
&lt;p>When the USB drive is plugged in, I can use grub command line to chainload the EFI file that is located in the ISO partition, or the VBR if it&amp;rsquo;s booted with legacy mode.&lt;/p>
&lt;p>Well, it&amp;rsquo;s usable but I still feel that it is too much for a small USB drive - too many partitions. If I plug the drive in for just data exchange, there would be a a bunch of partitions mounted and the notification is quite annoying. So I started thinking that there must be a simpler way to do it.&lt;/p>
&lt;h1 id="new-solution---much-better">New Solution - Much Better&lt;/h1>
&lt;h2 id="partitioning">Partitioning&lt;/h2>
&lt;p>The goal is simplicity so the new partition scheme is like this:&lt;/p>
&lt;pre>&lt;code>/dev/sda1 - 100 GB. NTFS. Data partition
/dev/sda2 - 512 MB. FAT. EFI partition
/dev/sda3 - 1 MB. No filesystem. BIOS boot partition used by GRUB (Optional)
&lt;/code>&lt;/pre>&lt;p>The third BIOS boot partition is not really necessary since most of computers nowadays are using UEFI. If you really need the legacy compatibility, you can create one. I&amp;rsquo;ll keep it for now.&lt;/p>
&lt;h2 id="installing-grub">Installing GRUB&lt;/h2>
&lt;p>Typical GRUB insallation but install for both EFI and BIOS.&lt;/p>
&lt;pre>&lt;code class="language-console" data-lang="console"># mount /dev/sda2 /mnt
# grub-install --target=x86_64-efi --efi-directory=/mnt --boot-directory=/mnt --removable
# grub-install --target=i386-pc --boot-directory=/mnt /dev/sda
&lt;/code>&lt;/pre>&lt;p>Don&amp;rsquo;t forget to create a GRUB menu config file. Otherwise GRUB will boot into its command line interface (If you know what you&amp;rsquo;re doing). It&amp;rsquo;s a good idea to put a editable config file in the data partition since it will be the most used partition. However, GRUB reads the file in the EFI partition by default: &lt;code>(esp)/grub/grub.cfg&lt;/code>. We can tell GRUB to read out custom config file after that.&lt;/p>
&lt;pre>&lt;code class="language-grub" data-lang="grub"># (esp)/grub/grub.cfg
search --set=root --file /boot.cfg
configfile /boot.cfg
&lt;/code>&lt;/pre>&lt;p>Thus we are done with the EFI partition. All the menu configuration will go into &lt;code>boot.cfg&lt;/code> in the data partition.&lt;/p>
&lt;h2 id="linux-installer">Linux Installer&lt;/h2>
&lt;p>Most of modern Linux distros support booting from a loop device. That is to say, we don&amp;rsquo;t have to extract the content of ISO files. Using GRUB &lt;code>loopback&lt;/code> command can easily mount a ISO and boot from there. But chainloading the EFI or VBF is not possible. Based on the &lt;a class="link" href="https://www.gnu.org/software/grub/manual/grub/grub.html#Loopback-booting" target="_blank" rel="noopener"
>GRUB manual&lt;/a>:&lt;/p>
&lt;blockquote>
&lt;p>GRUB is able to read from an image (be it one of CD or HDD) stored on any of its accessible storages (refer to see loopback command). However the OS itself should be able to find its root. This usually involves running a userspace program running before the real root is discovered.&lt;/p>
&lt;/blockquote>
&lt;p>EFI bootloader usually will fail to find the root device by this method. However, we can manually load the kernel and ramdisk in which we can specify the root device by ourselves.&lt;/p>
&lt;h3 id="load-linux-iso">Load Linux ISO&lt;/h3>
&lt;p>I&amp;rsquo;m using Arch Linux here for example.&lt;/p>
&lt;ol>
&lt;li>Put the ISO file to &lt;code>(data)/images/archlinux-2022.01.01-x86_64.iso&lt;/code>.&lt;/li>
&lt;li>Mount ISO. We need to find the kernel loading parameters.&lt;/li>
&lt;li>In the file &lt;code>(arch)/syslinux/archiso_sys-linux.cfg&lt;/code> we would see&lt;/li>
&lt;/ol>
&lt;pre>&lt;code class="language-config" data-lang="config"># Copy to RAM boot option
LABEL arch64ram
TEXT HELP
Boot the Arch Linux install medium on BIOS with Copy-to-RAM option
It allows you to install Arch Linux or perform system maintenance.
ENDTEXT
MENU LABEL Arch Linux install medium (x86_64, BIOS, Copy to RAM)
LINUX /arch/boot/x86_64/vmlinuz-linux
INITRD /arch/boot/intel-ucode.img,/arch/boot/amd-ucode.img,/arch/boot/x86_64/initramfs-linux.img
APPEND archisobasedir=arch archisolabel=ARCH_202201 copytoram
&lt;/code>&lt;/pre>&lt;p>This is a &lt;code>syslinux&lt;/code> config file. Parameters after &lt;code>APPEND&lt;/code> are the ones that we&amp;rsquo;re looking for.&lt;/p>
&lt;p>Then add the following content to &lt;code>(data)/boot.cfg&lt;/code>. When copying the &lt;code>initrd&lt;/code> parameters, don&amp;rsquo;t forget to remove commas.&lt;/p>
&lt;pre>&lt;code class="language-config" data-lang="config">menuentry &amp;quot;Archiso 202201 RAM&amp;quot; {
search --set=root --file /boot.cfg
loopback loop /images/archlinux-2022.01.01-x86_64.iso
set root=(loop)
linux /arch/boot/x86_64/vmlinuz-linux archisobasedir=arch archisolabel=ARCH_202201 copytoram
initrd /arch/boot/intel-ucode.img /arch/boot/amd-ucode.img /arch/boot/x86_64/initramfs-linux.img
}
&lt;/code>&lt;/pre>&lt;p>Then the Linux installer is done. If we need more distros, the process is similar.&lt;/p>
&lt;h2 id="windows-installer">Windows Installer&lt;/h2>
&lt;p>I prefer to use NTFS as my data partition&amp;rsquo;s file system because it works on both Linux and Windows, and supports big files. Also I usually just keep one copy of Windows installer so for Windows, I can simply dump the ISO content to the data partition&amp;rsquo;s root. I don&amp;rsquo;t mind the extra a few folders there. Plus some of them can be safely deleted. Then chainloading from GRUB is possible.&lt;/p>
&lt;p>In &lt;code>(data)/boot.cfg&lt;/code>&lt;/p>
&lt;pre>&lt;code class="language-config" data-lang="config">menuentry &amp;quot;Windows 10 Installer&amp;quot; {
search --set=root --file /boot.cfg
chainloader /efi/boot/bootx64.efi
}
&lt;/code>&lt;/pre>&lt;h2 id="windows-pe">Windows PE&lt;/h2>
&lt;p>Alternatively, I can directly boot from a small WinPE image and use &lt;code>dism&lt;/code> command to extract &lt;code>install.wim&lt;/code> to the target without accepting the annoying Windows partition scheme (You know what I&amp;rsquo;m talking about).&lt;/p>
&lt;p>To create a PE image we need a Windows environment and a CMD window with admin privilege.&lt;/p>
&lt;p>Create a virtual disk to contain PE files. Assigned with volume letter &lt;code>P:\&lt;/code>.&lt;/p>
&lt;pre>&lt;code class="language-console" data-lang="console">&amp;gt; diskpart
DISKPART&amp;gt; create vdisk file=c:\winpe.vhd maximum=2000 type=fixed
DISKPART&amp;gt; select vdisk file=c:\winpe.vhd
DISKPART&amp;gt; attach vdisk
DISKPART&amp;gt; convert mbr
DISKPART&amp;gt; create partition primary
DISKPART&amp;gt; format fs=ntfs quick
DISKPART&amp;gt; assign letter=p
DISKPART&amp;gt; exit
&lt;/code>&lt;/pre>&lt;p>Then mount the Windows installer ISO. Assuming the assigned volume is &lt;code>G:\&lt;/code>.&lt;/p>
&lt;pre>&lt;code class="language-console" data-lang="console">dism /apply-image /imagefile:g:\sources\boot.wim /index:1 /applydir:p:\
dism /image:p:\ /set-targetpath:x:\
dism /image:p:\ /set-inputlocale:en-us
dism /image:p:\ /set-userlocale:en-us
&lt;/code>&lt;/pre>&lt;p>Assign EFI partition with volume letter &lt;code>E:\&lt;/code>.&lt;/p>
&lt;p>Before creating the bootloader for Windows PE, we need to backup our GRUB EFI file (Windows PE bootloader will overwrite it). Rename &lt;code>E:\EFI&lt;/code> to &lt;code>E:\EFI-grub&lt;/code>.&lt;/p>
&lt;p>Create Windows PE bootloader.&lt;/p>
&lt;pre>&lt;code class="language-console" data-lang="console">&amp;gt; bcdboot p:\Windows /l en-us /s e: /f uefi
&lt;/code>&lt;/pre>&lt;p>Then merge both &lt;code>E:\EFI&lt;/code> and &lt;code>E:\EFI-grub&lt;/code>. If it prompts overwriting &lt;code>E:\EFI\Boot\bootx64.efi&lt;/code>, confirm with yes.&lt;/p>
&lt;p>Then add following content to &lt;code>(data)/boot.cfg&lt;/code>.&lt;/p>
&lt;pre>&lt;code class="language-config" data-lang="config">menuentry &amp;quot;Windows PE&amp;quot; {
search --set=root --file /boot.cfg
chainloader /EFI/Microsoft/Boot/bootmgfw.efi
}
&lt;/code>&lt;/pre>&lt;h2 id="loading-any-iso">Loading Any ISO&lt;/h2>
&lt;p>Some ISO is capable to be loaded directly into memory. The size of the ISO file is critical. Generally it should not exceed the physical memory. This can be done by &lt;code>memdisk&lt;/code> from &lt;code>syslinux&lt;/code>.&lt;/p>
&lt;p>Copy the &lt;code>memdisk&lt;/code> into the EFI partition.&lt;/p>
&lt;pre>&lt;code class="language-console" data-lang="console"># cp /usr/lib/syslinux/bios/memdisk (esp)/memdisk
&lt;/code>&lt;/pre>&lt;p>Then put the following content to &lt;code>(data)/boot.cfg&lt;/code>. For example, loading a Windows PE ISO.&lt;/p>
&lt;pre>&lt;code class="language-config" data-lang="config">menuentry &amp;quot;Windows PE ISO&amp;quot; {
search --set=root --file /boot.cfg
linux16 memdisk iso ro
initrd16 /images/winpe.iso
}
&lt;/code>&lt;/pre>&lt;h1 id="the-end">The End&lt;/h1>
&lt;p>Finally I&amp;rsquo;m very satisfied with this new USB drive. Yay!&lt;/p></description></item><item><title>Moving From Vim to Emacs</title><link>https://peromage.github.io/p/moving-from-vim-to-emacs/</link><pubDate>Sat, 14 Aug 2021 10:29:09 -0400</pubDate><guid>https://peromage.github.io/p/moving-from-vim-to-emacs/</guid><description>&lt;p>YouTube has been pushing me a lot Emacs related contents. This is weird since mostly I watch Vim videos only. But probably this is also a great opportunity to try Emacs again.&lt;/p>
&lt;p>I have tried Emacs half year ago. I looked a lot Elisp programming fundamentals and tried a few Emacs configurations from others including Doom Emacs. However, it didn&amp;rsquo;t last long since I found that I didn&amp;rsquo;t have enough time to configure this Emacs setup as good as the &lt;a class="link" href="https://github.com/peromage/rice.vim" target="_blank" rel="noopener"
>Vim setup&lt;/a> that I was using. Also using other&amp;rsquo;s configurations makes things become complicated for me. They have too many packages included and I don&amp;rsquo;t know what they are whether they are useful for me or not.&lt;/p>
&lt;p>After watching a bunch of Emacs videos I decided to pick it up this time, with vanilla Emacs starting from scratch. The reason why I make my mind this time is because I found Emacs can perfectly and elegantly solve some problems that pain my ass:&lt;/p>
&lt;ul>
&lt;li>More convenient package management.&lt;/li>
&lt;li>High quality packages.&lt;/li>
&lt;li>Easier file management in shell environment (Dired)&lt;/li>
&lt;li>No third party dependencies like Node.js and Python. The two major plugs that I&amp;rsquo;m using in Vim are Coc and Leaderf. They require Node.js and Python to work. Since Elisp is power enough, Emacs can handle this easily by itself.&lt;/li>
&lt;li>Server-client architecture. I can even replace Tmux with Emacs now. NeoVim has the similar concept but it cannot match what Emacs has.&lt;/li>
&lt;li>Graphical interface in X mode. This makes Emacs be able to display rich contents.&lt;/li>
&lt;li>Org mode. It looks great to organize to-do list and take notes without switching to other applications.&lt;/li>
&lt;li>Evil mode. No need to worry about missing Vim&amp;rsquo;s features.&lt;/li>
&lt;li>Magit. Looks way better and nicer than fugitive.&lt;/li>
&lt;li>Elisp Right. Elisp is fun üòâ.&lt;/li>
&lt;/ul>
&lt;p>The migration is going slowly. Right now my main setup is still Vim + Tmux. There is a little curve learning from vanilla edition of Emacs, but It&amp;rsquo;s not a big deal compared with the first time when I started learning Vim üôÇ.&lt;/p>
&lt;p>In the end, dont&amp;rsquo;t give me wrong. Vim and Emacs both are great text editor. For me, Vim is more like a spirit, a concept. Once you&amp;rsquo;ve learned its high-efficiency key maps, you can use it everywhere. Even though I switch to Emacs I still use Vim mode together with Emacs' powerful extendability. Why not?&lt;/p></description></item><item><title>Dual-booting Windows VHD and Native Linux on a BIOS+GPT PC</title><link>https://peromage.github.io/p/dual-booting-windows-vhd-and-native-linux-on-a-bios-gpt-pc/</link><pubDate>Fri, 09 Jul 2021 16:40:31 +0000</pubDate><guid>https://peromage.github.io/p/dual-booting-windows-vhd-and-native-linux-on-a-bios-gpt-pc/</guid><description>&lt;h1 id="background">Background&lt;/h1>
&lt;p>Previously I wrote a post for this dual-boot scenario. It is a little outdated. In the past year I mostly worked in the Linux environment on my old laptop, so the Windows seems not to be a necessity which occupies a dedicated partition. However, sometimes it is still needed. That is why I started thinking to improve this setup even further.&lt;/p>
&lt;p>Starting from Windows 7, Windows supports boots from a VHD file which makes it so much easier to manage. Also you are able to create differencing disks which are pretty much like snapshots.&lt;/p>
&lt;p>For this new configuration, my plan is to use &lt;em>BIOS + GPT disk table + Native Linux + Native Windows booting from VHD + GRUB as the bootloader&lt;/em>.&lt;/p>
&lt;h1 id="partitioning">Partitioning&lt;/h1>
&lt;p>To make GPT works with BIOS. It is required to have a small partition &lt;a class="link" href="https://wiki.archlinux.org/title/GRUB" target="_blank" rel="noopener"
>flagged&lt;/a> with &lt;code>EF02&lt;/code>.&lt;/p>
&lt;p>The partition scheme looks like this:&lt;/p>
&lt;pre>&lt;code>Device Start End Sectors Size Type
/dev/sda1 34 2047 2014 1007K BIOS boot
/dev/sda2 2048 1026047 1024000 500M EFI System
/dev/sda3 1026048 206546943 205520896 98G Linux filesystem
/dev/sda4 206546944 835692543 629145600 300G Linux filesystem
/dev/sda5 835692544 1465149134 629456591 300.1G Microsoft basic data
&lt;/code>&lt;/pre>&lt;h1 id="installing-linux">Installing Linux&lt;/h1>
&lt;p>Any Linux distro would work. I chose Manjaro KDE this time because I found that the Pop OS made my laptop really hot sometimes (Yeah KDE is prettier).&lt;/p>
&lt;p>This part should be easy. The GRUB files is going into that EFI partition. For details, check &lt;a class="link" href="https://wiki.archlinux.org/title/GRUB" target="_blank" rel="noopener"
>GRUB wiki&lt;/a>.&lt;/p>
&lt;h1 id="preparing-to-install-windows">Preparing to Install Windows&lt;/h1>
&lt;p>I&amp;rsquo;m not going to use the standard Windwos installer since I want to install it into a VHD file. To make it work we need a Windows PE environment.&lt;/p>
&lt;h2 id="preparing-images">Preparing Images&lt;/h2>
&lt;p>Any Windows PE (Windows 7 and above) would work. The PE ISO image is going to &lt;code>/boot/wepe.iso&lt;/code>.&lt;/p>
&lt;p>Also a Windows ISO image is needed. For example a Windows 7 ISO named &lt;code>windows7.iso&lt;/code> will be put in the Windows data partition.&lt;/p>
&lt;h2 id="adding-windows-pe-to-grub">Adding Windows PE to GRUB&lt;/h2>
&lt;p>Boot into Linux. Download Windows PE ISO file and move it to the EFI partition (EXT4 partitions might be problematic).&lt;/p>
&lt;p>To load this ISO image, &lt;code>memdisk&lt;/code> tool from &lt;code>syslinux&lt;/code> is required. Steps as below on Arch based distro:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="c1"># Installing syslinux&lt;/span>
$ sudo pacman -S syslinux
&lt;span class="c1"># Copying `memdisk` to the boot partition&lt;/span>
$ sudo cp /usr/lib/syslinux/bios/memdisk /boot/memdisk
&lt;span class="c1"># Adding Windows PE entry to GRUB. 1DB1-9C31 is the boot partition&amp;#39;s UUID&lt;/span>
$ sudo cat &lt;span class="s">&amp;lt;&amp;lt;EOF &amp;gt;&amp;gt;/etc/grub.d/40_custom
&lt;/span>&lt;span class="s">menuentry &amp;#34;WePE x64&amp;#34; {
&lt;/span>&lt;span class="s"> search --set=root --no-floppy --fs-uuid 1DB1-9C31
&lt;/span>&lt;span class="s"> linux16 /memdisk iso ro
&lt;/span>&lt;span class="s"> initrd16 /wepe.iso
&lt;/span>&lt;span class="s">}
&lt;/span>&lt;span class="s">EOF&lt;/span>
&lt;span class="c1"># Updating GRUB entries&lt;/span>
$ sudo grub-mkconfig -o /boot/grub/grub.cfg
&lt;/code>&lt;/pre>&lt;/div>&lt;h1 id="installing-windows-to-a-vhd-file">Installing Windows to a VHD File&lt;/h1>
&lt;p>After adding Windows PE to the bootloader entries, it is time to switch the working environment.&lt;/p>
&lt;p>Restart the PC, then keep pression &lt;code>shift&lt;/code> key until the GRUB menu shows up. Now navigate to the Windows PE entry and get in there.&lt;/p>
&lt;h2 id="creating-a-vhd-file-for-windows">Creating a VHD File for Windows&lt;/h2>
&lt;p>To create a VHD file, open a command line window and enter &lt;code>diskpart&lt;/code>&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-cmd" data-lang="cmd"># Create a VHD file assuming the NTFS data partition is assigned with D:
DISKPART&lt;span class="p">&amp;gt;&lt;/span> create vdisk file=d:\windows7.vhd maximum=64000 type=fixed
DISKPART&lt;span class="p">&amp;gt;&lt;/span> select vdisk file=d:\windows7.vhd
DISKPART&lt;span class="p">&amp;gt;&lt;/span> attach vdisk
# Disk table type doesn&amp;#39;t matter but using MBR for better compatibility
DISKPART&lt;span class="p">&amp;gt;&lt;/span> convert mbr
# Create the system partition and assign it with C:
DISKPART&lt;span class="p">&amp;gt;&lt;/span> create partition primary
DISKPART&lt;span class="p">&amp;gt;&lt;/span> format fs=ntfs quick
DISKPART&lt;span class="p">&amp;gt;&lt;/span> assign letter=c
DISKPART&lt;span class="p">&amp;gt;&lt;/span> exit
&lt;/code>&lt;/pre>&lt;/div>&lt;p>Now the Windows image can be dumped into this VHD file.&lt;/p>
&lt;h2 id="extracting-windows-image">Extracting Windows Image&lt;/h2>
&lt;p>Mount the Windows ISO image to &lt;code>E:&lt;/code> volume and open a command line window&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-cmd" data-lang="cmd"># Get the image index. For example the desired version&amp;#39;s index is 1
&lt;span class="p">&amp;gt;&lt;/span> dism /get-wiminfo /wimfile=e:\sources\install.wim
# Extract the image. Where E: is the Windows ISO and C: is the VHD file
&lt;span class="p">&amp;gt;&lt;/span> dism /apply-image /imagefile:e:\sources\install.wim /index:1 /applydir:c:\
&lt;/code>&lt;/pre>&lt;/div>&lt;h1 id="fixing-the-windows-bootloader">Fixing the Windows Bootloader&lt;/h1>
&lt;p>Stay in Windows PE. Don&amp;rsquo;t restart the PC. We still need to fix the bootloader for Windows.&lt;/p>
&lt;p>Normally Windows cannot be booted with a GPT+MBR setup. And also loading the whole Windows VHD file through &lt;code>memdisk&lt;/code> is not possible because it&amp;rsquo;s too large to load into memory. To fix the boot issue a bridge is needed between Windows and GRUB.&lt;/p>
&lt;p>Luckily &lt;a class="link" href="http://reboot.pro/index.php?showtopic=19516&amp;amp;page=2&amp;amp;#entry184489" target="_blank" rel="noopener"
>a small VHD image&lt;/a> can still be loaded by &lt;code>memdisk&lt;/code>.&lt;/p>
&lt;p>The idea is: GRUB -&amp;gt; MS Bootmgr VHD -&amp;gt; Windows VHD&lt;/p>
&lt;h2 id="creating-a-dedicated-bootloader-image-for-windows">Creating a Dedicated Bootloader Image for Windows&lt;/h2>
&lt;p>It is same with the process creating a VHD file for Windows system but this time it is a smaller file (32 MB).&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-cmd" data-lang="cmd"># Create a small bootmgr VHD file in the data partition
DISKPART&lt;span class="p">&amp;gt;&lt;/span> create vdisk file=d:\bootmgr.vhd maximum=32 type=fixed
DISKPART&lt;span class="p">&amp;gt;&lt;/span> select vdisk file=d:\bootmgr.vhd
DISKPART&lt;span class="p">&amp;gt;&lt;/span> attach vdisk
DISKPART&lt;span class="p">&amp;gt;&lt;/span> convert mbr
DISKPART&lt;span class="p">&amp;gt;&lt;/span> create partition primary
DISKPART&lt;span class="p">&amp;gt;&lt;/span> format fs=ntfs quick
DISKPART&lt;span class="p">&amp;gt;&lt;/span> assign letter=f
DISKPART&lt;span class="p">&amp;gt;&lt;/span> exit
&lt;/code>&lt;/pre>&lt;/div>&lt;p>Now the &lt;code>bootmgr&lt;/code> VHD is mounted at F:. Then write the boot record and create boot configuration files.&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-cmd" data-lang="cmd">&lt;span class="p">&amp;gt;&lt;/span> bootsect /nt60 f: /mbr
&lt;span class="p">&amp;gt;&lt;/span> bcdboot c:\Windows /l en-us /s f: /f bios
&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="fixing-the-bcd-entry">Fixing the BCD Entry&lt;/h2>
&lt;p>At this point it should be working according to the &lt;a class="link" href="https://docs.microsoft.com/en-us/windows-hardware/manufacture/desktop/boot-to-vhd--native-boot--add-a-virtual-hard-disk-to-the-boot-menu" target="_blank" rel="noopener"
>Microsoft&amp;rsquo;s document&lt;/a>. In fact it is not.&lt;/p>
&lt;p>Let&amp;rsquo;s check the BCD entries, in a command window:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-cmd" data-lang="cmd">&lt;span class="p">&amp;gt;&lt;/span> bcdedit /store f:\Boot\BCD /enum
Windows Boot Manager
--------------------
identifier {bootmgr}
device partition=F:
description Windows Boot Manager
locale en-us
inherit {globalsettings}
default {default}
resumeobject {fcd67427-e033-11eb-8826-cdf90e3873d0}
displayorder {default}
toolsdisplayorder {memdiag}
timeout 30
Windows Boot Loader
-------------------
identifier {default}
device partition=C:
&lt;span class="k">path&lt;/span> \Windows\system32\winload.exe
description Windows 7
locale en-us
inherit {bootloadersettings}
osdevice partition=C:
systemroot \Windows
resumeobject {fcd67427-e033-11eb-8826-cdf90e3873d0}
nx OptIn
detecthal Yes
&lt;/code>&lt;/pre>&lt;/div>&lt;p>The &lt;code>device&lt;/code> and &lt;code>osdevice&lt;/code> seems to be right but once the Windows VHD is unmounted it becomes &lt;code>unknown&lt;/code>. According to this &lt;a class="link" href="http://www.mistyprojects.co.uk/documents/BCDEdit/files/device.htm" target="_blank" rel="noopener"
>BCDEdit notes&lt;/a>, BCD entry records the partition&amp;rsquo;s information such as UUID to find the correct partition during bootup. In this case the partition can&amp;rsquo;t be found until the VHD file is mounted. But this VHD file is not mounted automatically.&lt;/p>
&lt;p>Thus we need to correct this and let &lt;code>Bootmgr&lt;/code> locate the VHD file properly.&lt;/p>
&lt;p>In a command line window:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-cmd" data-lang="cmd"># The identifier must match the one which is showing above
&lt;span class="p">&amp;gt;&lt;/span> bcdedit /store C:\Boot\BCD /set {default} device vhd=[D:]\windows7.vhd
&lt;span class="p">&amp;gt;&lt;/span> bcdedit /store C:\Boot\BCD /set {default} osdevice vhd=[D:]\windows7.vhd
&lt;/code>&lt;/pre>&lt;/div>&lt;p>If we check the BCD entry again it doesn&amp;rsquo;t change. But if we unmount the Windows VHD it will become:&lt;/p>
&lt;pre>&lt;code>&amp;gt; bcdedit /store f:\Boot\BCD /enum
Windows Boot Manager
--------------------
identifier {bootmgr}
device partition=E:
description Windows Boot Manager
locale en-us
inherit {globalsettings}
default {default}
resumeobject {fcd67427-e033-11eb-8826-cdf90e3873d0}
displayorder {default}
toolsdisplayorder {memdiag}
timeout 30
Windows Boot Loader
-------------------
identifier {default}
device vhd=[C:]\windows7.vhd
path \Windows\system32\winload.exe
description Windows 7
locale en-us
inherit {bootloadersettings}
osdevice vhd=[C:]\windows7.vhd
systemroot \Windows
resumeobject {fcd67427-e033-11eb-8826-cdf90e3873d0}
nx OptIn
detecthal Yes
&lt;/code>&lt;/pre>&lt;p>The volume letter doesn&amp;rsquo;t matter, it changes dynamically. Now &lt;code>bootmgr&lt;/code> is able to locate the VHD file correctly.&lt;/p>
&lt;h1 id="adding-windows-to-grub">Adding Windows to GRUB&lt;/h1>
&lt;p>Restart PC and get into Linux.&lt;/p>
&lt;p>Modify the GRUB config file to load &lt;code>bootmgr&lt;/code>&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="c1"># Adding Windows (bootmgr) entry to GRUB. 1DB1-9C31 is the boot partition&amp;#39;s UUID&lt;/span>
$ sudo cat &lt;span class="s">&amp;lt;&amp;lt;EOF &amp;gt;&amp;gt;/etc/grub.d/40_custom
&lt;/span>&lt;span class="s">menuentry &amp;#34;Windows 7&amp;#34; {
&lt;/span>&lt;span class="s"> search --set=root --no-floppy --fs-uuid 1DB1-9C31
&lt;/span>&lt;span class="s"> linux16 /memdisk harddisk
&lt;/span>&lt;span class="s"> initrd16 /bootmgr.vhd
&lt;/span>&lt;span class="s">}
&lt;/span>&lt;span class="s">EOF&lt;/span>
&lt;span class="c1"># Updating GRUB entries&lt;/span>
$ sudo grub-mkconfig -o /boot/grub/grub.cfg
&lt;/code>&lt;/pre>&lt;/div>&lt;p>Now we can restart PC. Keep pressing &lt;code>shift&lt;/code> on bootup to go to the GRUB menu. Select Windows entry to boot Windows.&lt;/p>
&lt;h1 id="fixing-windows-initialization-error">Fixing Windows Initialization Error&lt;/h1>
&lt;p>During the first time bootup, Windows might have an error showing &lt;em>Windows could not complete the installation. To install Windows on this computer, restart the installation&lt;/em>.&lt;/p>
&lt;p>To &lt;a class="link" href="https://www.howisolve.com/windows-could-not-complete-the-installation-solved/" target="_blank" rel="noopener"
>solve&lt;/a> this error:&lt;/p>
&lt;ol>
&lt;li>Press &lt;code>SHIFT + F10&lt;/code> to bring up the command prompt.&lt;/li>
&lt;li>Execute &lt;code>C:\windows\system32\oobe\msoobe&lt;/code>.&lt;/li>
&lt;li>Wait for a while and the setup window will show up.&lt;/li>
&lt;li>Complete the setup and restart.&lt;/li>
&lt;/ol>
&lt;h1 id="creating-a-differencing-disk">Creating a Differencing Disk&lt;/h1>
&lt;p>A differencing disk can be used for quick recoveries.&lt;/p>
&lt;p>To create it, restart into the Windows PE environment. In a command line window:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-cmd" data-lang="cmd"># Use the original VHD as base
&lt;span class="p">&amp;gt;&lt;/span> move d:\windows7.vhd d:\windows7_base.vhd
# Create a differencing disk based on the original one
# The name of the new differencing disk has to be the name that was recorded in the BCD
&lt;span class="p">&amp;gt;&lt;/span> diskpart
DISKPART&lt;span class="p">&amp;gt;&lt;/span> creat vdisk file=d:\windows7.vhd parent=d:\windows7_base.vhd
&lt;/code>&lt;/pre>&lt;/div>&lt;p>Then all changes made in the future will go into the differencing disk. If system goes wrong one day, simply deleting the the differencing disk and creating a new one would quickly recover from the crysis.&lt;/p>
&lt;p>&lt;strong>NOTE: After creating the differencing disk, the base VHD is not supposed to be modified.&lt;/strong>&lt;/p>
&lt;h1 id="references">References&lt;/h1>
&lt;ul>
&lt;li>&lt;a class="link" href="https://wiki.archlinux.org/title/GRUB" target="_blank" rel="noopener"
>GRUB wiki&lt;/a>&lt;/li>
&lt;li>&lt;a class="link" href="https://wzyboy.im/post/1049.html" target="_blank" rel="noopener"
>BIOS + GPT + GRUB + Linux + Windows ÊäòËÖæÁ¨îËÆ∞&lt;/a>&lt;/li>
&lt;li>&lt;a class="link" href="https://rimo.site/2017/02/08/install-win7-into-vhd/" target="_blank" rel="noopener"
>Âú® VHD ‰∏≠ÂÆâË£Ö Windows 7&lt;/a>&lt;/li>
&lt;li>&lt;a class="link" href="http://reboot.pro/index.php?showtopic=19516&amp;amp;page=2&amp;amp;#entry184489" target="_blank" rel="noopener"
>Hack Bootmgr to boot Windows in BIOS to GPT&lt;/a>&lt;/li>
&lt;li>&lt;a class="link" href="https://docs.microsoft.com/en-us/windows-hardware/manufacture/desktop/boot-to-vhd--native-boot--add-a-virtual-hard-disk-to-the-boot-menu" target="_blank" rel="noopener"
>Boot to a virtual hard disk: Add a VHDX or VHD to the boot menu&lt;/a>&lt;/li>
&lt;li>&lt;a class="link" href="http://www.mistyprojects.co.uk/documents/BCDEdit/files/device.htm" target="_blank" rel="noopener"
>BCDEdit notes&lt;/a>&lt;/li>
&lt;li>&lt;a class="link" href="https://www.howisolve.com/windows-could-not-complete-the-installation-solved/" target="_blank" rel="noopener"
>100% Solved:Windows could not complete the installation&lt;/a>&lt;/li>
&lt;/ul></description></item><item><title>Git ‰∏≠ÁöÑ Subtree Âíå Submodule</title><link>https://peromage.github.io/p/git-%E4%B8%AD%E7%9A%84-subtree-%E5%92%8C-submodule/</link><pubDate>Fri, 07 Apr 2017 20:53:53 +0000</pubDate><guid>https://peromage.github.io/p/git-%E4%B8%AD%E7%9A%84-subtree-%E5%92%8C-submodule/</guid><description>&lt;p>Âõ†‰∏∫ÊúÄËøëÂºÑËá™Â∑±ÁöÑÂçöÂÆ¢ÔºåÊ∂âÂèäÂà∞‰∫ÜÁâàÊú¨Â∫ìÂµåÂ•óÁöÑÈóÆÈ¢ò„ÄÇËÆ∞‰∏ãÊù•‰πüÁÆóÊòØÁªôËá™Â∑±‰∏Ä‰∏™Â§áÂøò„ÄÇ&lt;/p>
&lt;h1 id="‰∏∫‰ªÄ‰πàÊúâËøôÊ†∑ÁöÑÈúÄÊ±Ç">‰∏∫‰ªÄ‰πàÊúâËøôÊ†∑ÁöÑÈúÄÊ±Ç&lt;/h1>
&lt;p>ÁâàÊú¨Â∫ìÂµåÂ•óÂæàÂ•ΩÁêÜËß£ÔºåÂ∞±ÊòØÂú®‰∏Ä‰∏™ Git ‰ªìÂ∫ìÈáåÈù¢ÂåÖÂê´‰∫ÜÂÖ∂‰ªñÁöÑ Git ‰ªìÂ∫ì„ÄÇÈÄöÂ∏∏ÊúâËøôÊ†∑ÁöÑÈúÄÊ±ÇÂæÄÂæÄÊ∂âÂèäÂà∞ÂçèÂêåÂºÄÂèë„ÄÇÊØîÂ¶ÇËøôÈáåÊúâ‰∏Ä‰∏™Êèí‰ª∂ÂçïÁã¨ÁöÑ Git ‰ªìÂ∫ìÂßë‰∏îÂè´‚ÄúPlugin‚Äù„ÄÇÁé∞Âú®ÊàëÂàõÂª∫‰∫Ü‰∏Ä‰∏™Ëá™Â∑±ÁöÑÈ°πÁõÆÔºåÂÖ∂‰∏≠ÈúÄË¶ÅÁî®Âà∞Ëøô‰∏™‚ÄúPlugin‚ÄùÊèí‰ª∂„ÄÇÈÄöÂ∏∏ÊØîËæÉÁ¨®ÁöÑÂäûÊ≥ïÂ∞±ÊòØÊääÊèí‰ª∂Â∫ìÊ∫êÁ†ÅÊãñ‰∏ãÊù•ÔºåÂ§çÂà∂Âà∞Ëá™Â∑±ÁöÑÈ°πÁõÆÈáå„ÄÇ‰ΩÜÊòØËøôÊ†∑ÂΩìÊèí‰ª∂Â∫ìÊõ¥Êñ∞ÁöÑÊó∂ÂÄôÔºåÊèí‰ª∂Ê∫êÁ†ÅÊõ¥Êñ∞ÂæÄÂæÄÊØîËæÉÈ∫ªÁÉ¶„ÄÇËÄå‰∏îÂ¶ÇÊûúÂú®‰ΩøÁî®ÁöÑËøáÁ®ã‰∏≠‰øÆÊîπ‰∫ÜÊèí‰ª∂ÁöÑÊ∫êÁ†ÅÔºå‰πü‰∏ç‰æø‰∫éÊèí‰ª∂ÂçïÁã¨ÁöÑÁâàÊú¨ÊéßÂà∂ÔºåÊõ¥Âà´ËØ¥‰∏∫Êèí‰ª∂Â∫ìË¥°ÁåÆ‰ª£Á†Å‰∫Ü„ÄÇ‰ΩÜÂ¶ÇÊûúÊèí‰ª∂ÂçïÁã¨‰ª• Git ‰ªìÂ∫ìÂ≠òÂú®‰∫éÊàëÁöÑÈ°πÁõÆÁõÆÂΩï‰∏≠Ôºå‰ª•‰∏äÁöÑÈóÆÈ¢òÂ∞±Ëß£ÂÜ≥‰∫Ü„ÄÇ&lt;/p>
&lt;p>Âú® Git ÈáåÈù¢Êèê‰æõ‰∫Ü‰∏§ÁßçÊñπÂºèÂÆûÁé∞‰∏äËø∞ÈúÄÊ±ÇÔºåÈÇ£Â∞±ÊòØ Subtree Âíå Submodule„ÄÇ&lt;/p>
&lt;h1 id="submodule">Submodule&lt;/h1>
&lt;p>Submodule ÊòØ Git ÈáåÈù¢ÊúÄÊó©Êèê‰æõÁöÑ‰∏ÄÁßçÊñπÊ≥ï„ÄÇÈ°æÂêçÊÄù‰πâ‚ÄúÂ≠êÊ®°Âùó‚Äù„ÄÇ&lt;/p>
&lt;h2 id="Ê∑ªÂä†Â≠êÊ®°Âùó">Ê∑ªÂä†Â≠êÊ®°Âùó&lt;/h2>
&lt;p>ÊâßË°å&lt;br>
&lt;code>git submodule add &amp;lt;repo&amp;gt; &amp;lt;module_path&amp;gt;&lt;/code>&lt;/p>
&lt;p>Ê≠§Êó∂ËøêË°å &lt;code>git status&lt;/code> ÂèØ‰ª•ÁúãÂà∞Â≠êÊ®°ÂùóÂØπÂ∫îÁöÑÊñá‰ª∂Â§πÂíå‰∏Ä‰∏™Âè´ÂÅö &lt;em>.gitmodules&lt;/em> Êñá‰ª∂Ë¢´Ê∑ªÂä†Ëøõ‰∫ÜÊöÇÂ≠òÂå∫„ÄÇÂÖ∂‰∏≠*.gitmodules*ÊòØÁî®‰∫éËÆ∞ÂΩïÂ≠êÊ®°ÂùóÁõ∏ÂÖ≥‰ø°ÊÅØÁöÑ„ÄÇ‰πãÂêé‰∏ªÈ°πÁõÆÈáåÈù¢ÁöÑÊìç‰ΩúÁÖßÂ∏∏Êèê‰∫§Â∞±ÂèØ‰ª•‰∫Ü„ÄÇ&lt;/p>
&lt;h2 id="‰øÆÊîπÂ≠êÊ®°Âùó">‰øÆÊîπÂ≠êÊ®°Âùó&lt;/h2>
&lt;p>‰ΩÜÂ¶ÇÊûúÂú®ÂºÄÂèëÁöÑÈÄî‰∏≠‰øÆÊîπ‰∫ÜÂ≠êÊ®°ÂùóÁöÑ‰ª£Á†ÅÔºåÈúÄË¶ÅÂçïÁã¨Âà∞Â≠êÊ®°ÂùóÂØπÂ∫îÁöÑÊ†πÁõÆÂΩïÈáåÈù¢ËøõË°åÂ≠êÊ®°ÂùóÂçïÁã¨ÁöÑÊèê‰∫§Êìç‰Ωú„ÄÇÂú®‰∏ªÈ°πÁõÆÈáåÈù¢ËôΩÁÑ∂ÂèØ‰ª•ÁúãÂà∞Â≠êÊ®°ÂùóÊúâÂèòÊõ¥Ôºå‰ΩÜÊòØÊó†Ê≥ïÁúãÂà∞ÂÖ∑‰ΩìÁöÑÊõ¥ÊîπÊìç‰ΩúÔºåËÄåÊòØÂ∞ÜÂÖ∂Áúã‰Ωú‰∏Ä‰∏™Ê®°ÂùóÊï¥‰Ωì„ÄÇ‰∏ÄÊó¶Â≠êÊ®°Âùó‰∫ßÁîü‰∫ÜÊñ∞ÁöÑÊèê‰∫§Ôºå‰∏ªÈ°πÁõÆÈáåÈù¢ÂèØ‰ª•ÁúãÂà∞Â≠êÊ®°ÂùóÁöÑ HEAD ÂèòÂåñÔºå‰ªéËÄå‰∏ªÈ°πÁõÆ‰πüÂ∫îÂΩì‰∫ßÁîü‰∏Ä‰∏™Êñ∞ÁöÑÊèê‰∫§‰ª•ËÆ∞ÂΩïÂØπÂ∫îÂÖ≥Á≥ª„ÄÇ&lt;br>
Êç¢Âè•ËØùËØ¥Ôºå‰∏ªÈ°πÁõÆÂ∞±ÊòØÈù†ÁùÄËÆ∞ÂΩïÂ≠êÊ®°Âùó HEAD ÂÄºÊù•Âà§Êñ≠‰æùËµñÁöÑ„ÄÇ&lt;strong>Â≠êÊ®°ÂùóÁöÑ‰ª£Á†ÅÊúÄÂêéÂ∞Ü‰∏ç‰ºöËøõÂÖ•‰∏ªÈ°πÁõÆÁöÑÁâàÊú¨Â∫ìÈáåÈù¢ÔºàÂè™Êúâ HEAD ÂÄºÔºâ&lt;/strong>&lt;/p>
&lt;p>Áé∞Âú®Â≠êÊ®°ÂùóÊúâ‰∫ÜÊñ∞ÁöÑÊèê‰∫§Ôºå‰∏∫‰∫ÜÂ∞ÜÊúçÂä°Âô®‰∏äÁöÑ‰ª£Á†ÅÊõ¥Êñ∞ÔºåÊàë‰ª¨Âè™ÈúÄË¶ÅËøõÂÖ•Â≠êÊ®°ÂùóÂØπÂ∫îÁöÑÊõ¥ÁõÆÂΩïÊâßË°å push Êìç‰ΩúÂ∞±ÂèØ‰ª•‰∫Ü„ÄÇ&lt;/p>
&lt;h2 id="Êõ¥Êñ∞Â≠êÊ®°Âùó">Êõ¥Êñ∞Â≠êÊ®°Âùó&lt;/h2>
&lt;p>Ê≠§Êó∂Â≠êÊ®°Âùó‰∏äÊ∏∏Êúâ‰∫ÜÊñ∞ÁöÑ‰ª£Á†ÅÔºåÊàë‰ª¨ÈúÄË¶ÅÂ∞ÜÂÖ∂Êï¥ÂêàÂà∞ÂΩìÂâçÁöÑÈ°πÁõÆ‰∏≠„ÄÇÊúâ‰∏§ÁßçÊñπÊ≥ï„ÄÇ&lt;/p>
&lt;p>Âú®‰∏ªÈ°πÁõÆÊ†πÁõÆÂΩï‰∏ãËøêË°å&lt;br>
&lt;code>git submodule foreach git pull&lt;/code>&lt;/p>
&lt;p>ÊàñËÄÖÂàáÊç¢Âà∞Â≠êÊ®°ÂùóÁöÑÊ†πÁõÆÂΩï‰∏ãÈù¢
&lt;code>git pull&lt;/code>&lt;/p>
&lt;h2 id="ÂÖãÈöÜÈ°πÁõÆ">ÂÖãÈöÜÈ°πÁõÆ&lt;/h2>
&lt;p>ÂÖãÈöÜ‰∏ªÈ°πÁõÆÁöÑÊó∂ÂÄôÂ≠êÊ®°ÂùóÂπ∂‰∏ç‰ºöÊãâÂèñÂà∞Êú¨Âú∞ÔºåÂ¶ÇÊûúËøõÂÖ•ÂØπÂ∫îÁöÑÁõÆÂΩï‰ºöÂèëÁé∞ÊòØÁ©∫ÁöÑ„ÄÇ&lt;br>
Ê≠§Êó∂Â∫îÂΩì&lt;br>
&lt;code>git submodule init&lt;/code>&lt;br>
‰øùÊåÅÊúÄÊñ∞&lt;br>
&lt;code>git submodule update&lt;/code>&lt;/p>
&lt;p>ÊàñËÄÖÂèØ‰ª•Áõ¥Êé•‰∏ÄÊù°ÂëΩ‰ª§ÊêûÂÆö&lt;br>
&lt;code>git clone --recursive &amp;lt;repo&amp;gt;&lt;/code>&lt;/p>
&lt;h2 id="Âà†Èô§Â≠êÊ®°Âùó">Âà†Èô§Â≠êÊ®°Âùó&lt;/h2>
&lt;p>Git ‰∏≠Ê≤°ÊúâÊèê‰æõÁõ¥Êé•Âà†Èô§ÁöÑÂëΩ‰ª§ÔºåÈúÄË¶ÅÊâãÂä®ÂÆåÊàêÂà†Èô§Êìç‰Ωú„ÄÇ&lt;/p>
&lt;p>ÂèçÂêëÂàùÂßãÂåñÂ≠êÊ®°Âùó&lt;br>
&lt;code>git submodule deinit --force &amp;lt;module_path&amp;gt;&lt;/code>&lt;br>
ÊàñËÄÖÁõ¥Êé•Âà†Êéâ &lt;em>.git/config&lt;/em> ÈáåÁõ∏ÂÖ≥‰ø°ÊÅØ&lt;/p>
&lt;p>ÁßªÈô§Â≠êÊ®°Âùó&lt;br>
&lt;code>git rm &amp;lt;module_path&amp;gt;&lt;/code>&lt;/p>
&lt;p>Â¶ÇÊûúÊöÇÂ≠òÂå∫ËøòÊúâ
&lt;code>git rm --cached &amp;lt;module_path&amp;gt;&lt;/code>&lt;/p>
&lt;h2 id="Â≠êÊ®°ÂùóÁöÑÂùë">Â≠êÊ®°ÂùóÁöÑÂùë&lt;/h2>
&lt;h3 id="Êèê‰∫§ÁöÑÂùë">Êèê‰∫§ÁöÑÂùë&lt;/h3>
&lt;p>ÂÅáËÆæÊúâ A B ‰∏§‰∏™‰∫∫ÂêåÊó∂Âú®ÂºÄÂèë‰∏Ä‰∏™È°πÁõÆÔºåËøô‰∏™È°πÁõÆÈáåÈù¢‰πüÂåÖÂê´‰∫Ü‰∏Ä‰∏™Â≠êÊ®°Âùó„ÄÇÊ≠§Êó∂ A ‰øÆÊîπ‰∫Ü‰∏öÂä°‰ª£Á†ÅÔºåÂêåÊó∂‰øÆÊîπ‰∫Ü‰∏Ä‰∏™Â≠êÊ®°ÂùóÈáåÈù¢ÁöÑ‰∏Ä‰∏™ bug „ÄÇA Â∞ÜËøôÊ¨°‰øÆÊîπÊèê‰∫§Ôºå‰∏ªÈ°πÁõÆÁöÑÊèê‰∫§ÈáåÈù¢ÊåáÂêë‰∫ÜÂ≠êÊ®°ÂùóÊñ∞ÁöÑ HEAD1 ÔºåÁÑ∂ÂêéÊää‰∏ªÈ°πÁõÆÁöÑÁâàÊú¨Â∫ì push Âà∞‰∫ÜÊúçÂä°Âô®Ôºå‰ΩÜÊòØÊ≤°Êúâ push Â≠êÊ®°Âùó„ÄÇB Ê≠§Êó∂ pull ‰∫Ü‰∏ªÈ°πÁõÆÔºåÁÑ∂Âêé update Â≠êÊ®°ÂùóÔºåË¢´ÂëäÁü•Êâæ‰∏çÂà∞Â≠êÊ®°ÂùóÁöÑ HEAD1 „ÄÇÂõ†‰∏∫ÊåáÂêë HEAD1 ÁöÑÊèê‰∫§ËøòÂú® A Êú¨Âú∞Êú∫Âô®‰∏ä„ÄÇ&lt;br>
ËøôÂ∞±ÊòØÂ≠êÊ®°ÂùóÊèê‰∫§ÁöÑÂùë„ÄÇÂú®Â§ö‰∏™Ê®°ÂùóÂ≠òÂú®ÁöÑÊó∂ÂÄôÊìç‰ΩúÈùûÂ∏∏ÁπÅÁêê„ÄÇ&lt;/p>
&lt;h3 id="ÂàùÂßãÂåñÁöÑÂùë">ÂàùÂßãÂåñÁöÑÂùë&lt;/h3>
&lt;p>Âú®ÊâßË°å &lt;code>git submodule init&lt;/code>Ôºå &lt;code>git submodule update&lt;/code> ‰πãÂêéÔºåÊ≠§Êó∂‰øÆÊîπÂ≠êÊ®°ÂùóÂèØËÉΩÂá∫Áé∞ HEAD Â§Ñ‰∫éÊ∏∏Á¶ªÁä∂ÊÄÅÁöÑÁöÑÊèêÁ§∫„ÄÇÂ¶ÇÊûú‰∏çÊ≥®ÊÑèÊûÅÊúâÂèØËÉΩÂá∫Áé∞‰∏¢Â§±Êèê‰∫§ÁöÑÂèØËÉΩ„ÄÇ&lt;br>
Ëß£ÂÜ≥ÂäûÊ≥ïÔºåÂú®‰ª•‰∏ä‰∏§Êù°ÂëΩ‰ª§‰πãÂêéÊâßË°å‰∏ÄÊ¨°Ê£ÄÂá∫&lt;br>
&lt;code>git checkout &amp;lt;branch&amp;gt;&lt;/code>&lt;/p>
&lt;h1 id="subtree">Subtree&lt;/h1>
&lt;h2 id="Ê∑ªÂä†Â≠êÈ°πÁõÆ">Ê∑ªÂä†Â≠êÈ°πÁõÆ&lt;/h2>
&lt;p>È¶ñÂÖàÊ∑ªÂä†Â≠êÈ°πÁõÆÂØπÂ∫îÁöÑËøúÁ®ãÊúçÂä°Âô®&lt;br>
&lt;code>git remote add &amp;lt;subrepo_name&amp;gt; &amp;lt;subrepo_remote&amp;gt;&lt;/code>&lt;/p>
&lt;p>ÊãâÂèñ‰∏Ä‰∏ã&lt;br>
&lt;code>git fetch &amp;lt;subrepo_name&amp;gt;&lt;/code>&lt;/p>
&lt;p>Ê∑ªÂä†Â≠êÈ°πÁõÆÂà∞Áà∂È°πÁõÆÈáåÈù¢&lt;br>
&lt;code>git subtree add --squash --prefix=&amp;lt;subrepo_path&amp;gt; &amp;lt;subrepo_name&amp;gt; &amp;lt;branch&amp;gt;&lt;/code>&lt;br>
ÂèÇÊï∞ &lt;em>&amp;ndash;squash&lt;/em> ‰ΩúÁî®Âú®‰∫éÂêàÂπ∂Â≠êÈ°πÁõÆÊâÄÊúâÊèê‰∫§‰∏∫‰∏Ä‰∏™ÔºåÂπ∂ merge Âà∞Áà∂È°πÁõÆÁöÑÂéÜÂè≤‰∏≠ÔºåËøôÊ†∑Âè™‰ºöÂá∫Áé∞‰∏§‰∏™Êèê‰∫§ËÆ∞ÂΩïÔºåÈÅøÂÖçÂ≠êÈ°πÁõÆÁöÑÊèê‰∫§ÂéÜÂè≤Ê±°ÊüìÁà∂È°πÁõÆ„ÄÇÊõ¥Â§öËÆ®ËÆ∫ÂèØ‰ª•Áúã&lt;a class="link" href="http://www.fwolf.com/blog/post/246" target="_blank" rel="noopener"
>&lt;strong>ËøôÈáå&lt;/strong>&lt;/a>„ÄÇ&lt;/p>
&lt;h2 id="‰øÆÊîπÂ≠êÈ°πÁõÆ">‰øÆÊîπÂ≠êÈ°πÁõÆ&lt;/h2>
&lt;p>Ê∑ªÂä†ÂÆåÊØï‰πãÂêéÁÖßÂ∏∏‰øÆÊîπÊèê‰∫§ÂêÑÁßçÊìç‰ΩúÔºåÁà∂È°πÁõÆËÉΩÂ§üË∑üË∏™Â≠êÈ°πÁõÆÈáåÈù¢ÁöÑÊâÄÊúâÂèòÊõ¥„ÄÇÂ≠êÈ°πÁõÆË¢´ÂΩìÂÅö‰∏Ä‰∏™Ê≠£Â∏∏ÁöÑÂ≠êÊñá‰ª∂Â§πÂ§ÑÁêÜ„ÄÇ&lt;/p>
&lt;p>Â¶ÇÊûúÁé∞Âú®‰øÆÊîπ‰∫ÜÂ≠êÈ°πÁõÆÈáåÁöÑ‰∏Ä‰∏™ bug Âπ∂‰∏îÊÉ≥Ë¶ÅÂèçÈ¶àÁªô‰∏äÊ∏∏ÔºåÂèØ‰ª•ËøôÊ†∑Êìç‰Ωú&lt;br>
&lt;code>git subtree push --prefix=&amp;lt;subrepo_path&amp;gt; &amp;lt;subrepo_name&amp;gt; &amp;lt;bug_fixed&amp;gt;&lt;/code>&lt;br>
Ëøô‰∏™Êìç‰ΩúÂèØ‰ª•Â∞ÜÁà∂È°πÁõÆÈáåÊâÄÊúâÊ∂âÂèäÂ≠êÈ°πÁõÆ‰øÆÊîπÁöÑÊèê‰∫§Ê£ÄÂá∫„ÄÇËøôÊ†∑Âú®ËøúÁ®ã‰ªìÂ∫ìÈáåÈù¢‰ºöÂá∫Áé∞‰∏Ä‰∏™Âè´ÂÅö &lt;em>bug_fixed&lt;/em> ÁöÑÂàÜÊîØ„ÄÇ&lt;/p>
&lt;p>ÊàñËÄÖ‰πüÂèØ‰ª•ËøôÊ†∑Êìç‰Ωú&lt;br>
&lt;code>git subtree split --prefix=&amp;lt;subrepo_path&amp;gt; --branch &amp;lt;new_branch_name&amp;gt;&lt;/code>&lt;br>
Ëøô‰∏™Êìç‰ΩúË∑ü‰∏äÈù¢‰∏ÄÊ†∑Â∞ÜÁà∂È°πÁõÆÈáåÊâÄÊúâÊ∂âÂèäÂ≠êÈ°πÁõÆ‰øÆÊîπÁöÑÊèê‰∫§Ê£ÄÂá∫ÔºåÂπ∂‰∏îÊääÂ≠êÈ°πÁõÆÁöÑÊ†πÊñá‰ª∂Â§πËÆæ‰∏∫Êï¥‰∏™È°πÁõÆÁöÑÊ†πÊñá‰ª∂Â§πÔºåÁÑ∂ÂêéÊ£ÄÂá∫‰∏∫Áà∂È°πÁõÆÁöÑ‰∏Ä‰∏™Êñ∞ÁöÑÂàÜÊîØ„ÄÇ&lt;/p>
&lt;p>ÁÑ∂ÂêéÊé®ÈÄÅÁªô‰∏äÊ∏∏&lt;br>
&lt;code>git push &amp;lt;subrepo_remote&amp;gt; &amp;lt;new_branch_name&amp;gt;:&amp;lt;bug_fixed&amp;gt;&lt;/code>&lt;/p>
&lt;p>‰πãÂêéÂà†Èô§ÂØπÂ∫îÊú¨Âú∞ÂàÜÊîØÂ∞±ÂèØ‰ª•‰∫Ü„ÄÇ&lt;/p>
&lt;h2 id="Êõ¥Êñ∞Â≠êÈ°πÁõÆ">Êõ¥Êñ∞Â≠êÈ°πÁõÆ&lt;/h2>
&lt;p>ÊãâÂèñÈùûÂ∏∏Êñπ‰æø&lt;br>
&lt;code>git subtree pull --prefix=&amp;lt;subrepo_path&amp;gt; &amp;lt;subrepo_name&amp;gt; &amp;lt;branch&amp;gt;&lt;/code>&lt;/p>
&lt;h2 id="Âà†Èô§Â≠êÈ°πÁõÆ">Âà†Èô§Â≠êÈ°πÁõÆ&lt;/h2>
&lt;p>Âõ†‰∏∫Â≠êÈ°πÁõÆÂú®Áà∂È°πÁõÆÈáåÈù¢Â∞±ÊòØË¢´ÂΩìÂÅö‰∏Ä‰∏™ÊôÆÈÄöÁöÑÊñá‰ª∂Â§πÂ§ÑÁêÜÁöÑÔºåÊâÄ‰ª•Áõ¥Êé•ÁßªÈô§Êñá‰ª∂Â§πÂπ∂Êèê‰∫§Â∞±ÂèØ‰ª•‰∫Ü„ÄÇ&lt;/p>
&lt;h1 id="submodule-vs-subtree">Submodule vs. Subtree&lt;/h1>
&lt;p>Git ÂÆòÊñπÊé®Ëçê‰ΩøÁî®Êñ∞ÁöÑ Subtree Ôºå‰∫ãÂÆûËØÅÊòéÁöÑÁ°ÆÊØî Submodule Êñπ‰æø‰∏çÂ∞ë„ÄÇSubtree ‰∏ç‰ºö‰∫ßÁîüÈ¢ùÂ§ñÁöÑÊñá‰ª∂ÔºåËÄå‰∏îÂ≠êÈ°πÁõÆÁöÑ‰ª£Á†ÅÂåÖÂê´Âú®Áà∂È°πÁõÆÈáåÈù¢Ôºå‰∏ç‰ºöÂá∫Áé∞ÂâçÈù¢ÊèêÂà∞ÁöÑÂùëÁöÑÈóÆÈ¢ò„ÄÇÂÖ∑‰ΩìÂ∫îÁî®‰∏äÁöÑÂØπÊØîÂèØ‰ª•ÂèÇËÄÉ&lt;a class="link" href="https://gist.github.com/kvnsmth/4688345" target="_blank" rel="noopener"
>&lt;strong>ËøôÁØáÊñáÁ´†&lt;/strong>&lt;/a>„ÄÇSubtree ÂØπ‰∫é‰ª£Á†ÅËø≠‰ª£ËæÉÂø´ÁöÑÈ°πÁõÆÂ∞§‰∏∫ÈÄÇÂêà„ÄÇ&lt;/p>
&lt;p>‰ΩÜ‰πü‰∏çÊòØËØ¥ Submodule ‰∏ÄÊó†ÊòØÂ§ÑÔºå Submodule Âú®ÊàëÊÑüËßâÊúÄÂ§ßÁöÑÊÑè‰πâÂú®‰∫éÂèØ‰ª•ÈöîÁ¶ªÂ≠êÈ°πÁõÆÁöÑ‰∏öÂä°‰ª£Á†ÅÔºåÂπ∂‰∏îËÆ∞ÂΩï‰∏•Ê†ºÁöÑ‰æùËµñÂÖ≥Á≥ª„ÄÇÂØπ‰∫é‰∏Ä‰∫õÂ≠êÊ®°ÂùóÊõ¥Êñ∞ËæÉÊÖ¢ÁöÑÈ°πÁõÆËøòÊòØÊØîËæÉÈÄÇÂêàÁöÑ„ÄÇ&lt;/p></description></item><item><title>Windows + Linux ÂèåÁ≥ªÁªüÂºïÂØºÊâãËÆ∞</title><link>https://peromage.github.io/p/windows-linux-%E5%8F%8C%E7%B3%BB%E7%BB%9F%E5%BC%95%E5%AF%BC%E6%89%8B%E8%AE%B0/</link><pubDate>Wed, 05 Apr 2017 19:26:41 +0000</pubDate><guid>https://peromage.github.io/p/windows-linux-%E5%8F%8C%E7%B3%BB%E7%BB%9F%E5%BC%95%E5%AF%BC%E6%89%8B%E8%AE%B0/</guid><description>&lt;h1 id="0x00-ÊÉÖÂÜµÁÆÄËø∞">0x00 ÊÉÖÂÜµÁÆÄËø∞&lt;/h1>
&lt;p>Áî±‰∫éÂºÄÂèëÈúÄË¶Å Linux ÁéØÂ¢ÉÔºåÊâÄ‰ª•Â∞ÜËÄÅÁöÑÈÇ£Âè∞Á¨îËÆ∞Êú¨ÊîπÈÄ†Êàê‰∫ÜÂèåÁ≥ªÁªü„ÄÇ&lt;br>
ËøôÂè∞ÁîµËÑëÁöÑÂü∫Êú¨ÊÉÖÂÜµÊòØËøôÊ†∑ÁöÑÔºå64GB Âõ∫ÊÄÅÁ°¨Áõò + 720GB Êú∫Ê¢∞Á°¨ÁõòÔºàÂÆûÈôÖÂèØÁî®Á©∫Èó¥ÊúâÊäòÊçüÔºåËøôÈáå‰∏∫‰∫ÜË°®Á§∫Êñπ‰æøÔºâÔºåWindows 10 Â∑≤ÁªèÂÆâË£ÖÂà∞‰∫ÜÂõ∫ÊÄÅÁ°¨Áõò‰∏ä„ÄÇÁî±‰∫é‰∏ªÊùøËæÉËÄÅÔºåÂè™ËÉΩÊîØÊåÅ BIOS„ÄÇÂ∑®Á°¨ÂèàËØ¥Ëøá Windows Âè™ËÉΩÊîØÊåÅ BIOS + MBRÔºåÊâÄ‰ª•Á¨¨‰∏ÄÂùó‰∏ª‰ΩçÔºàMasterÔºâ‰∏äÁöÑÂõ∫ÊÄÅÁ°¨ÁõòÂ∞±Âè™ËÉΩÈááÁî® MBR ÂàÜÂå∫Ë°®ÔºåÂàÜÊàê‰∫Ü‰∏§‰∏™Âå∫Ôºå500MB Áî®‰ΩúÂêØÂä®ÂàÜÂå∫ÔºåÂâ©‰∏ãÁöÑÈÉ®ÂàÜÂÖ®ÈÉ®ÂàíÁªô‰∫ÜÁ≥ªÁªüÂàÜÂå∫„ÄÇ&lt;br>
‰ΩÜÊòØ Linux Ë°®Á§∫Ê≤°ÊúâÂ∑®Á°¨ËøôÁßçÂ∞øÊÄßÔºåÊâÄ‰ª•‰∏∫‰ªÄ‰πà‰∏ç‰ΩøÁî®Êõ¥ÂÖàËøõÁöÑ GPT ÂàÜÂå∫Ë°®ÔºüÂõ†Ê≠§‰ªé‰ΩçÔºàSlaveÔºâ‰∏äÁöÑÊú∫Ê¢∞Á°¨ÁõòË¢´ÊàëÂàÜÊàê‰∫ÜËøô‰∏™Ê†∑Â≠êÔºö&lt;br>
&lt;strong>10MB BIOS ÂêØÂä®ÂàÜÂå∫ÔºàNo File SystemÔºâ + 500MB /boot ÂêØÂä®ÊåÇËΩΩÁÇπÔºàEXT4Ôºâ + 100GB / Ê†πÊåÇËΩΩÁÇπÔºàEXT4Ôºâ + 199.5GB /home Áî®Êà∑ÁõÆÂΩïÊåÇËΩΩÁÇπÔºàEXT4Ôºâ + 420GB Windows Êï∞ÊçÆÂàÜÂå∫ÔºàNTFSÔºâ&lt;/strong>„ÄÇ&lt;br>
BIOS ÂêØÂä®ÂàÜÂå∫ 1MB Ë∂≥‰ª•ÔºåÊàëÂè™ÊòØËÄÉËôëÂà∞ÂêéÁª≠Êâ©Â±ïÈóÆÈ¢ò„ÄÇ‰πãÂêéÂú®Á¨¨‰∫åÂùóÁ°¨Áõò‰∏äÂÆâË£Ö‰∫Ü Arch Linux„ÄÇ&lt;/p>
&lt;h1 id="0x01-ÊúâÂï•Â•ΩÊäòËÖæÁöÑ">0x01 ÊúâÂï•Â•ΩÊäòËÖæÁöÑÔºü&lt;/h1>
&lt;p>ÂèåÁ≥ªÁªüÂÆâË£ÖÂ•Ω‰ª•ÂêéÁõ∏ÂÆâÊó†‰∫ãÔºåBIOS ÈªòËÆ§‰ªé‰∏ª‰ΩçÂõ∫ÊÄÅÁ°¨ÁõòÂêØÂä®„ÄÇ‰πüÂ∞±ÊòØËØ¥ÂºÄÊú∫‰∏çËøõË°å‰ªª‰ΩïÊìç‰ΩúÁöÑËØùÔºåÈªòËÆ§ËøõÂÖ•ÁöÑÊòØ Windows 10„ÄÇÂè™ÊúâÂú®ÂºÄÊú∫ÁöÑÊó∂ÂÄô‰ΩøÁî® BIOS ÁöÑ Fast Boot ÂäüËÉΩÔºåÈÄâÊã©‰ªéÁ¨¨‰∫åÂùóÁ°¨ÁõòÂêØÂä®ÊâçËÉΩËøõÂÖ• Arch Linux„ÄÇÊç¢Âè•ËØùËØ¥‰∏§‰∏™Á≥ªÁªüÂΩºÊ≠§ÈÉΩÊòØÈÄèÊòéÁöÑ„ÄÇ
‰ΩÜÊòØ‰Ωú‰∏∫‰∏Ä‰∏™Âº∫Ëø´ÁóáÂíåÂÆåÁæé‰∏ª‰πâËÄÖÔºå‰∏á‰∏ÄÊàëÊÉ≥ËøõÂÖ• LinuxÔºå‰ΩÜÊòØÂºÄÊú∫ÁöÑÊó∂ÂÄôÈîôËøá‰∫ÜÔºåÂ≤Ç‰∏çÊòØË¶ÅÈáçÂêØ‰∏ÄÊ¨°ÊâçË°åÔºüÊàñËÄÖ‰∏á‰∏ÄÊàëÂèàÂèçÊÇîÊÉ≥ËøõÂÖ• Windows ÂèàË¶ÅÈáçÂêØ‰∏ÄÊ¨°ÔºüËøôÊÄé‰πàËÉΩÂøçÔºåÊâÄ‰ª•ÊâçÊúâ‰∫ÜËøôÊ¨°ÁöÑÊäòËÖæ‚Ä¶‚Ä¶&lt;/p>
&lt;h1 id="0x02-Âú®-grub-‰∏≠Ê∑ªÂä†ÂºïÂØºËèúÂçï">0x02 Âú® GRUB ‰∏≠Ê∑ªÂä†ÂºïÂØºËèúÂçï&lt;/h1>
&lt;p>ÂØπ‰∫é GRUB ÔºàÊ≥®ÔºöËøôÈáåÊâÄËØ¥ÁöÑ GRUB ÊåáÁöÑÊòØ GRUB 2 ËÄå‰∏çÊòØ GRUB LegacyÔºâ ÂºïÂØºÁöÑ Linux Êù•ËØ¥ÔºåÂàáÊç¢Âà∞ Windows ÁöÑ &lt;em>bootmgr&lt;/em> ÊòØ‰∏Ä‰ª∂ÂæàÂÆπÊòìÁöÑ‰∫ãÊÉÖÔºåÊúÄÊñ∞ÁâàÁöÑ GRUB ÂèØ‰ª•Áõ¥Êé•ÂêØÂä® &lt;em>bootmgr&lt;/em> ËÄå‰∏çÈúÄË¶Å‰πãÂâçÁöÑ chainloading Ê®°Âºè„ÄÇ
ËøõÂÖ• Arch LinuxÔºå‰ª• root ÊùÉÈôêÁºñËæë &lt;em>&lt;strong>/etc/grub.d/40_custom&lt;/strong>&lt;/em> ÔºåÂä†ÂÖ•‰ª•‰∏ãËèúÂçïÔºö&lt;/p>
&lt;pre>&lt;code>menuentry &amp;quot;Switch to Microsoft Boot Manager&amp;quot; {
insmod part_msdos
insmod ntfs
insmod search_fs_uuid
insmod ntldr
search --fs-uuid --set=root 69B235F6749E84CE
ntldr /bootmgr
}
&lt;/code>&lt;/pre>&lt;p>&lt;code>insmod&lt;/code> ÊòØÁî®‰∫éÂä†ËΩΩÂøÖË¶ÅÁöÑÊ®°Âùó‰ª•‰æø GRUB ËØÜÂà´Âπ∂Ê≠£Á°ÆÂêØÂä® Windows„ÄÇÂÄºÂæóÊ≥®ÊÑèÁöÑÊòØÔºå&lt;code>search&lt;/code> ‰∏ÄË°åÊåáÂÆöÁöÑ UUID ‰∏é Linux ‰∏ã &lt;strong>&lt;code>lsblk -f&lt;/code>&lt;/strong> ÁúãÂà∞ÁöÑ UUID ÊòØ‰∏ç‰∏ÄÊ†∑ÁöÑÔºåÈúÄË¶Å‰ΩøÁî® &lt;strong>&lt;code>sudo grub-probe --target=fs_uuid -d /dev/sda1&lt;/code>&lt;/strong> Êù•Ëé∑Âèñ GRUB ‰∏ãÂØπÂ∫îÁöÑÂàÜÂå∫ UUID„ÄÇËøô‰∏™‰æãÂ≠ê‰∏≠ÔºåWindows ÂêØÂä®ÂàÜÂå∫ÊòØ &lt;em>sda1&lt;/em>„ÄÇUUID ÊòØÂîØ‰∏ÄÁöÑÔºåÂãøÁÖßÊê¨„ÄÇ&lt;/p>
&lt;p>ÂΩìÁÑ∂‰πüÂèØ‰ª•‰ΩøÁî®‰º†ÁªüÁöÑ chainloading Ê®°ÂºèÔºö&lt;/p>
&lt;pre>&lt;code>menuentry &amp;quot;Switch to Microsoft Boot Manager&amp;quot; {
insmod part_msdos
insmod ntfs
insmod search_fs_uuid
search --fs-uuid --set=root 69B235F6749E84CE
chainloader +1
}
&lt;/code>&lt;/pre>&lt;p>‰øùÂ≠ò‰ª•ÂêéÔºåÊâßË°å &lt;strong>&lt;code>sudo grub-mkconfig -o /boot/grub/grub.cfg&lt;/code>&lt;/strong> Ôºå‰ª•‰æøÊõ¥Êñ∞ÂêØÂä®ËèúÂçï„ÄÇ&lt;br>
‰∏çÊé®ËçêÁõ¥Êé•ÁºñËæë &lt;em>&lt;strong>/boot/grub/grub.cfg&lt;/strong>&lt;/em>ÔºåÂõ†‰∏∫‰∏äËø∞ÂëΩ‰ª§‰ºöË¶ÜÁõñËøô‰∏™Êñá‰ª∂Ôºå‰∏ç‰æø‰∫éËá™ÂÆö‰πâËèúÂçïÁöÑÁÆ°ÁêÜ„ÄÇ&lt;br>
ËøôÊ†∑Â∞±ÂèØ‰ª•Áõ¥Êé•Ë∑≥ËΩ¨Âà∞ &lt;em>bootmgr&lt;/em>ÔºåËÆ©ÂÆÉÂéªÂêØÂä® Windows„ÄÇ&lt;/p>
&lt;h1 id="0x03-bcd-ÂØªÊÄù">0x03 BCD ÂØªÊÄù&lt;/h1>
&lt;p>BCD ÊòØWindows Vista ‰πãÂêé‰ΩøÁî®ÁöÑ‰∏ÄÁßçÂêØÂä®ÁÆ°ÁêÜÂô®„ÄÇÊúâ‰∏™ÈùûÂ∏∏ËõãÁñºÁöÑÈóÆÈ¢òÂ∞±Âú®‰∫éÔºåBCD Âπ∂‰∏çÊîØÊåÅ EXT4 ÂàÜÂå∫Ê†ºÂºèÔºåÊâÄ‰ª•Ê≤°ÊúâÂäûÊ≥ïËØªÂà∞ GRUB„ÄÇÊü•ÈòÖ‰∫ÜÁõ∏ÂÖ≥ËµÑÊñôÔºåÁªôÂá∫ÁöÑËß£ÂÜ≥ÂäûÊ≥ïÂ∞±ÊòØÔºåÂ∞Ü &lt;em>&lt;strong>/boot&lt;/strong>&lt;/em> ÂàÜÂå∫Ê†ºÂºèÂåñÊàê FAT32 ÁöÑÊñá‰ª∂Á≥ªÁªü„ÄÇÈöæÈÅìÊàëËøòÂæóÂÜçÊäòËÖæ‰∏ÄÊ¨°Êñá‰ª∂Á≥ªÁªüÔºüÁõ¥ËßâÂëäËØâÊàë‰∏ÄÂÆöËøòÊúâÂÖ∂‰ªñÁöÑÂäûÊ≥ï„ÄÇ&lt;br>
Êó¢ÁÑ∂ BCD Ê≤°ÂäûÊ≥ïÁõ¥Êé•ËØª EXT4 ÂàÜÂå∫ÈáåÈù¢ÁöÑ‰∏úË•øÔºåÊàë‰ª¨ÂèØ‰ª•Êõ≤Á∫øÊïëÂõΩ„ÄÇBCD ÈáåÈù¢Êèê‰æõ‰∫Ü‰∏ÄÁßçÂÆûÊ®°ÂºèÂêØÂä®ÁöÑÊñπÂºèÔºåÂÖÅËÆ∏ËØªÂèñ‰∏Ä‰∏™ÂåÖÂê´‰∫ÜÂêØÂä®‰ª£Á†ÅÁöÑÊñá‰ª∂„ÄÇÊâÄ‰ª•‰∏ÄÁßçËß£ÂÜ≥ÂäûÊ≥ïÂ∞±ÊòØ &lt;strong>BCD ‚Üí MBR ‚Üí VBR ‚Üí Bootloader&lt;/strong>„ÄÇÁî±‰∫é GPT Á£ÅÁõòÁöÑÁ¨¨‰∏Ä‰∏™ÊâáÂå∫Ë¢´ÂàíÂàÜÊàê‰∫Ü Protective MBRÔºåÁî®‰∫éÂÖºÂÆπ BIOSÔºåÊâÄ‰ª•Âú® Linux ‰ΩøÁî®Ôºö&lt;br>
&lt;strong>&lt;code>sudo dd if=/dev/sdb of=/mnt/reserved/grub.bin bs=512 count=1&lt;/code>&lt;/strong>&lt;br>
ÂèØ‰ª•Â∞ÜÁ¨¨‰∫åÂùóÁ°¨ÁõòÁöÑÁ¨¨‰∏ÄÊâáÂå∫ÈáåÈù¢ÁöÑÂêØÂä®‰ª£Á†ÅÂØºÂá∫Âà∞‰∏Ä‰∏™Êñá‰ª∂ÔºåÁÑ∂Âêé‰ΩøÁî® BCD Âä†ËΩΩËøô‰∏™Êñá‰ª∂Â∞±ÂèØ‰ª•ÂêØÂä® GRUB‰∫Ü„ÄÇ&lt;br>
ÊûúÁúüÂ¶ÇÊ≠§Ôºü&lt;br>
‰∫ãÂÆûÊòØÔºåËøôÁßçÊñπÊ≥ïÂèØË°åÔºå‰ΩÜÊòØÂπ∂‰∏çÈÄÇÁî®ÊàëÁöÑÊÉÖÂÜµÔºåÂõ†‰∏∫ËøôÊòØÂª∫Á´ãÂú® Windows Âíå Linux ÂÆâË£ÖÂú®Âêå‰∏ÄÂùóÁ°¨Áõò‰∏äÁöÑÊÉÖÂΩ¢„ÄÇ&lt;em>grub.bin&lt;/em> Âπ∂‰∏çËÉΩÂ§üË∑®ÂàÜÂå∫ÂØªÊâæ VBR„ÄÇÈöæÈÅìÂè™ËÉΩ‰ΩúÁΩ¢ÔºüËÇØÂÆö‰∏çÂèØËÉΩÔºå‰∏çÁÑ∂Â∞±Ê≤°ÊúâËøôÁØáÊñáÁ´†‰∫Ü„ÄÇ&lt;br>
Êü•ÈòÖ‰∫ÜËã•Âπ≤ÊñáÊ°£‰πãÂêéÔºåÂæóÁü• GRUB Êèê‰æõ‰∫Ü‰∏Ä‰∏™ Âè´ÂÅö &lt;em>lnxboot.img&lt;/em> Êñá‰ª∂ÔºåÂèØ‰ª•Â∞Ü GRUB ÂêØÂä®Èò∂ÊÆµÊ®°ÊãüÊàê‰∏Ä‰∏™ÂèØ‰ª•ÂêØÂä®ÁöÑ Linux ÂÜÖÊ†∏ÔºåÁÑ∂ÂêéÊåÇËΩΩ &lt;em>core.img&lt;/em> ÈáåÈù¢ÂøÖË¶ÅÁöÑÊ®°ÂùóÔºå‰ªéËÄåÈ°∫Âà©ÂêØÂä® GRUB„ÄÇÈÇ£‰πàÂ∞Ü‰πãÂâçÁöÑÊÄùË∑Ø‰øÆÊîπÊàê &lt;strong>BCD ‚Üí VBR ‚Üí Bootloader&lt;/strong> Â∞±Ë°å‰∫ÜÔºåÂç≥Êó¢ÁÑ∂ MBR ‰∏çËÉΩË∑®ÂàÜÂå∫‰ª•ÂèäËØÜÂà´ GPTÔºåÈÇ£‰πàÊàë‰ª¨Â∞±Êç¢Êàê‰∏Ä‰∏™ÂèØ‰ª•ËÉú‰ªªÁöÑ‰∏çÂ∞±Ë°å‰∫Ü„ÄÇ&lt;/p>
&lt;h1 id="0x04-Âà∂‰ΩúÂêØÂä®ÈïúÂÉè">0x04 Âà∂‰ΩúÂêØÂä®ÈïúÂÉè&lt;/h1>
&lt;p>ËøõÂÖ• Arch Linux„ÄÇËôΩÁÑ∂Âú® &lt;em>&lt;strong>/boot/grub/i386-pc/&lt;/strong>&lt;/em> ÁõÆÂΩï‰∏ãÊúâ‰∏Ä‰∏™Áî®‰∫éÂêØÂä®ÁöÑ &lt;em>core.img&lt;/em> Êñá‰ª∂ÔºåËøô‰∏™Êñá‰ª∂ÈáåÈù¢ÊåáÂÆöÁöÑÊ®°ÂùóË∑ØÂæÑÊòØÁõ∏ÂØπË∑ØÂæÑÔºå‰ΩøÁî®ÂÆÉÂêØÂä®‰æùÁÑ∂‰ºöÊòæÁ§∫ÈîôËØØÔºåÈúÄË¶ÅÊåáÂÆöÁªùÂØπË∑ØÂæÑ‰ª•‰øùËØÅ‰∏áÊó†‰∏ÄÂ§±„ÄÇÈÇ£‰πàÊàë‰ª¨Â∞±Êù•ÊâãÂä®ÁîüÊàê‰∏Ä‰∏™ÔºåÈ°∫‰æøÈõÜÊàê‰∏Ä‰∫õÊàë‰ª¨ÈúÄË¶ÅÁöÑÊ®°Âùó„ÄÇ&lt;br>
Ê≥®ÊÑèÔºåÂêØÂä®ÈïúÂÉèÁ®çÂêé‰ºöË¢´ÊîæÂú® Windows ÁöÑÂêØÂä®ÂàÜÂå∫‰∏ãÈù¢ÔºàBCD ÁöÑÂêØÂä®ÂàÜÂå∫ÔºâÔºåÊâÄ‰ª•ËøòÈúÄË¶ÅÁü•ÈÅìÊ®°ÂùóÊâÄÂú®ÂàÜÂå∫ÁöÑ‰ΩçÁΩÆ„ÄÇÂú® GRUB ‰∏≠Ë°®Á§∫Á£ÅÁõòÁöÑÊñπÂºèÊúâÊâÄ‰∏çÂêåÔºåÂ¶Ç &lt;em>(hd0,msdos1)&lt;/em> Ë°®Á§∫Á¨¨‰∏ÄÂùóÁ£ÅÁõòÔºå‰ΩøÁî® MBR ÂàÜÂå∫Ë°®ÔºåÁ¨¨‰∏Ä‰∏™ÂàÜÂå∫Ôºõ &lt;em>(hd1,gpt2)&lt;/em> Ë°®Á§∫Á¨¨‰∫åÂùóÁ£ÅÁõòÔºå‰ΩøÁî® GPTÂàÜÂå∫Ë°®ÔºåÁ¨¨‰∫å‰∏™ÂàÜÂå∫„ÄÇÊã¨Âè∑‰∏çÂèØÁúÅÔºåÁ£ÅÁõòÂíåÂàÜÂå∫ÁöÑËµ∑ÂßãÊï∞Â≠ó‰∏ç‰∏ÄÊ†∑„ÄÇ&lt;/p>
&lt;p>‰ΩøÁî® &lt;code>grub-probe&lt;/code> Êù•Ëé∑Âèñ &lt;em>&lt;strong>/boot&lt;/strong>&lt;/em> ÂàÜÂå∫‰ø°ÊÅØ„ÄÇËøô‰∏™‰æãÂ≠êÂæóÂà∞ÁöÑÊòØ &lt;em>hd1,gpt2&lt;/em>Ôºö&lt;br>
&lt;strong>&lt;code>sudo grub-probe --target=bios_hints /boot&lt;/code>&lt;/strong>&lt;/p>
&lt;p>ÁîüÊàê &lt;em>core.img&lt;/em>Ôºö&lt;br>
&lt;strong>&lt;code>sudo grub-mkimage --output=/tmp/core.img --prefix=\(hd1,gpt2\)/grub --format=i386-pc biosdisk part_msdos part_gpt ext2&lt;/code>&lt;/strong>&lt;br>
Ê≥®ÊÑèÂÉèÊàëËøôÊ†∑ &lt;em>&lt;strong>/boot&lt;/strong>&lt;/em> ÂçïÁã¨ÂàÜÂå∫Ôºåprefix Â∞±‰∏çÈúÄË¶ÅÂÜôÊàê &lt;em>&lt;strong>\(hd1,gpt2\)/boot/grub&lt;/strong>&lt;/em>ÔºåÊØïÁ´üÂ∑≤ÁªèÂú® &lt;em>&lt;strong>/boot&lt;/strong>&lt;/em> ÈáåÈù¢‰∫ÜÂòõ„ÄÇÈªòËÆ§Ê≤°Êúâ GPT ÊîØÊåÅÔºåÊâÄ‰ª•ËøòÈúÄË¶ÅÊ∑ªÂä† GPT Ê®°Âùó„ÄÇ&lt;/p>
&lt;p>ÁîüÊàêÂêØÂä®ÈïúÂÉèÔºö&lt;br>
ÊåâÁÖß GRUB ÁöÑÂ∏ÆÂä©ÊñáÊ°£Ôºå&lt;em>lnxboot.img&lt;/em> ÈúÄË¶ÅÊîæÂú® &lt;em>core.img&lt;/em> ‰πãÂâçÔºåÁî± &lt;em>lnxboot.img&lt;/em> Êù•Âä†ËΩΩ &lt;em>core.img&lt;/em>„ÄÇÊâÄÂπ∏ BCD ÂèØ‰ª•‰∏ÄÊ¨°ËØªÂèñÂ§ß‰∫é‰∏Ä‰∏™ÊâáÂå∫Ôºà512BÔºâÁöÑÂÜÖÂÆπÔºåÊâÄ‰ª•Â∞ÜËøô‰∏§‰∏™Êñá‰ª∂ÂêàÂπ∂‰∏Ä‰∏ãÂç≥ÂèØÔºö&lt;br>
&lt;strong>&lt;code>sudo cat /usr/lib/grub/i386-pc/lnxboot.img /tmp/core.img &amp;gt; /tmp/grub4bcd.img&lt;/code>&lt;/strong>&lt;/p>
&lt;p>ÁÑ∂ÂêéÂ∞Ü &lt;em>grub4bcd.img&lt;/em> ÊîæÂà∞ Windows ÂêØÂä®ÂàÜÂå∫Ê†πÁõÆÂΩï‰∏ãÈù¢Â∞±ÂèØ‰ª•‰∫Ü„ÄÇÊ≥®ÊÑèÂÜÖÊ†∏ÈªòËÆ§Âè™ËÉΩ‰ª•Âè™ËØªÊ®°ÂºèÊåÇËΩΩ NFTS Êñá‰ª∂Á≥ªÁªüÔºåÈúÄË¶ÅÂÆâË£ÖÊâ©Â±ïÂåÖÊâçËÉΩËØªÂÜôÔºö&lt;br>
&lt;strong>&lt;code>sudo pacman -S ntfs-3g&lt;/code>&lt;/strong>&lt;br>
ÁÑ∂ÂêéÊåÇËΩΩÔºàÂÆâË£Ö‰∫Ü‰∏äËø∞Êâ©Â±ïÂåÖ‰πãÂêéÁîöËá≥‰∏çÁî®ÊåáÂÆöÂèÇÊï∞ÔºâÔºö&lt;br>
&lt;strong>&lt;code>sudo mount /dev/sda1 /mnt/reserved&lt;/code>&lt;/strong>&lt;/p>
&lt;p>Áé∞Âú®Â∞±ÂèØ‰ª•È°∫Âà©Âú∞Â∞ÜÂêØÂä®ÈïúÂÉèÂ§çÂà∂Âà∞ Windows ÂêØÂä®ÂàÜÂå∫‰∏ãÈù¢‰∫Ü„ÄÇ&lt;/p>
&lt;h1 id="0x05-Âú®-bcd-‰∏≠Ê∑ªÂä†ÂºïÂØºËèúÂçï">0x05 Âú® BCD ‰∏≠Ê∑ªÂä†ÂºïÂØºËèúÂçï&lt;/h1>
&lt;p>ÈáçÂêØËøõÂÖ• Windows 10„ÄÇ‰ª•ÁÆ°ÁêÜÂëòÊùÉÈôêÊâìÂºÄÂëΩ‰ª§Ë°å„ÄÇ&lt;/p>
&lt;p>Ê∑ªÂä†ÂÖ•Âè£Ôºö&lt;br>
&lt;strong>&lt;code>bcdedit /create /d &amp;quot;Switch to GRUB&amp;quot; /application bootsector&lt;/code>&lt;/strong>&lt;br>
‰ºöËøîÂõû‰∏Ä‰∏≤ UUIDÔºåÂ§çÂà∂‰∏ãÊù•„ÄÇ‰πãÂêé UUID ÁöÑÂú∞ÊñπÊàëÁî® &lt;strong>{ID}&lt;/strong> Ë°®Á§∫ÔºåÁî®ÂàöÊâçÂæóÂà∞ÁöÑÊõøÊç¢Âç≥ÂèØ„ÄÇ&lt;/p>
&lt;p>ËÆæÁΩÆÂêØÂä®ÂàÜÂå∫Ôºö&lt;br>
&lt;strong>&lt;code>bcdedit /set {ID} device boot&lt;/code>&lt;/strong>&lt;/p>
&lt;p>ËÆæÁΩÆÂêØÂä®Êñá‰ª∂Ôºö&lt;br>
&lt;strong>&lt;code>Bcdedit /set {ID} path /grub4bcd.img&lt;/code>&lt;/strong>&lt;/p>
&lt;p>Â∞ÜÂÖ•Âè£Ê∑ªÂä†ËøõÂêØÂä®ËèúÂçïÔºö &lt;br>
&lt;strong>&lt;code>bcdedit /displayorder {ID} /addlast&lt;/code>&lt;/strong>&lt;/p>
&lt;p>ÂÖ≥Èó≠ Metro ÂêØÂä®ËèúÂçïÔºà‰∏çÂÖ≥Èó≠ÁöÑËØùÂàáÊç¢Êó∂‰ºöÈáçÂêØÔºåÂª∫ËÆÆÂÖ≥Èó≠ÔºâÔºö&lt;br>
&lt;strong>&lt;code>bcdedit /set {default} bootmenupolicy legacy&lt;/code>&lt;/strong>&lt;/p>
&lt;p>ÊúÄÂêéÂÖ≥Èó≠ Windows 10 ÁöÑ Hybrid ÂºÄÊú∫ÂäüËÉΩÔºåÂê¶ÂàôÂèØËÉΩ‰ºöÂØºËá¥ Windows ‰∏¢Â§±Êï∞ÊçÆÔºö&lt;br>
&lt;strong>&lt;code>powercfg /h off&lt;/code>&lt;/strong>&lt;/p>
&lt;h1 id="0x06-ÂêéËÆ∞">0x06 ÂêéËÆ∞&lt;/h1>
&lt;p>Áé∞Âú®Áªà‰∫éÂèØ‰ª•ÊÑâÂø´Âú∞ÂàáÊç¢‰∏§‰∏™ÂºïÂØºËèúÂçï‰∫Ü„ÄÇÂÖ∂ÂÆû‰ΩøÁî® GRUB Êù•ÁÆ°ÁêÜ‰∏§‰∏™Á≥ªÁªüÊòØËæÉ‰∏∫ÁÆÄÂçïÁöÑÂäûÊ≥ï„ÄÇ&lt;br>
Êõ¥‰∏∫ÁÆÄÂçïÁöÑÂäûÊ≥ïÊòØÔºåÂÖàË£Ö Windows ÁÑ∂ÂêéË£Ö UbuntuÔºåÂêéËÄÖ‰ºöËá™Âä®ÊêûÂÆöËøô‰∫õÈ∫ªÁÉ¶‰∫ã„ÄÇ‚ïÆ(‚ïØ_‚ï∞)‚ï≠&lt;/p>
&lt;h1 id="0x07-ÂèÇËÄÉËµÑÊñô">0x07 ÂèÇËÄÉËµÑÊñô&lt;/h1>
&lt;p>&lt;em>&lt;a class="link" href="https://www.gnu.org/software/grub/manual/grub.html#Images" target="_blank" rel="noopener"
>https://www.gnu.org/software/grub/manual/grub.html#Images&lt;/a>&lt;/em>&lt;br>
&lt;em>&lt;a class="link" href="http://askubuntu.com/questions/180033/how-to-add-different-drive-ubuntu-to-bcd-manually" target="_blank" rel="noopener"
>http://askubuntu.com/questions/180033/how-to-add-different-drive-ubuntu-to-bcd-manually&lt;/a>&lt;/em>&lt;br>
&lt;em>&lt;a class="link" href="https://wiki.archlinux.org/index.php/Talk:Dual_boot_with_Windows" target="_blank" rel="noopener"
>https://wiki.archlinux.org/index.php/Talk:Dual_boot_with_Windows&lt;/a>&lt;/em>&lt;br>
&lt;em>&lt;a class="link" href="https://wiki.archlinux.org/index.php/Dual_boot_with_Windows" target="_blank" rel="noopener"
>https://wiki.archlinux.org/index.php/Dual_boot_with_Windows&lt;/a>&lt;/em>&lt;/p></description></item></channel></rss>